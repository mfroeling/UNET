(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     84346,       1776]
NotebookOptionsPosition[     77806,       1681]
NotebookOutlinePosition[     78214,       1697]
CellTagsIndexPosition[     78171,       1694]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"<<", "UNET`"}]], "Input",
 CellChangeTimes->{{3.850195738003997*^9, 3.8501957402197495`*^9}, 
   3.850282861003458*^9, 3.8523773063251095`*^9, {3.9012486542488256`*^9, 
   3.901248654643321*^9}, {3.90254962676322*^9, 3.9025496269793644`*^9}, {
   3.9025504379627414`*^9, 
   3.9025504382633953`*^9}},ExpressionUUID->"80736651-f97a-4200-a95d-\
e5276942b499"],

Cell[CellGroupData[{

Cell["Generated Data", "Section",
 CellChangeTimes->{{3.736158374831335*^9, 3.7361583784555874`*^9}, 
   3.7362558940026937`*^9, 
   3.736821898130583*^9},ExpressionUUID->"ebfce3f0-781e-489b-a324-\
413b4e2a0e96"],

Cell[CellGroupData[{

Cell["Show 2D UNET", "Subsection",
 CellChangeTimes->{{3.745075168901682*^9, 3.7450751811326494`*^9}, {
  3.750392396919392*^9, 3.7503923970805225`*^9}, {3.848564489585317*^9, 
  3.848564492492653*^9}},ExpressionUUID->"efe280f3-51c2-47b4-bc78-\
b0dd9eb22424"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dim", "=", 
   RowBox[{"{", 
    RowBox[{"112", ",", "112"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chan", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"class", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"feat", "=", "8"}], ";"}]}], "Input",
 CellChangeTimes->{{3.749959904969222*^9, 3.749959913431817*^9}, 
   3.8396568904512916`*^9, {3.8558912598712587`*^9, 3.855891285857575*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"c50cec09-b001-43dc-bce8-060fc1ebe1c5"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"chan", ",", "class", ",", "feat", ",", "dim", ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.745216488810031*^9, 3.7452165193851957`*^9}, {
   3.7459192848425136`*^9, 3.7459193016397495`*^9}, {3.746252116097231*^9, 
   3.746252123166115*^9}, 3.748869990911284*^9, {3.749959918028756*^9, 
   3.7499599182994757`*^9}, {3.752236566015766*^9, 3.7522365665872755`*^9}, {
   3.8557256515018997`*^9, 3.8557256516598277`*^9}, {3.855735927507738*^9, 
   3.8557359276255345`*^9}, 3.8558912972340283`*^9, {3.8562818692943373`*^9, 
   3.8562818715829134`*^9}, 3.8562832613349996`*^9, 3.901280534707328*^9, 
   3.9012806484678693`*^9, {3.9012849030467334`*^9, 3.901284907768176*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"f945d82f-8def-4ae4-8544-3ae92921c382"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"chan", ",", "class", ",", "feat", ",", "dim", ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UResNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7462521338213315`*^9, {3.7488699945277333`*^9, 3.7488699946229763`*^9}, 
   3.749873564378894*^9, {3.7499599274995117`*^9, 3.7499599278075113`*^9}, 
   3.7522365706070485`*^9, {3.855725653098079*^9, 3.855725653211825*^9}, {
   3.855735928528184*^9, 3.85573592867682*^9}, 3.855891299279773*^9, 
   3.9012805347394185`*^9, 3.901280650397976*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"71998f84-3622-409a-8e60-749763d086f5"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"chan", ",", "class", ",", "feat", ",", "dim", ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<ResNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7462521338213315`*^9, {3.7488699945277333`*^9, 3.7488699946229763`*^9}, {
   3.749959932431128*^9, 3.7499599327791405`*^9}, 3.752236571277831*^9, {
   3.8557256546519437`*^9, 3.8557256548274446`*^9}, {3.8557359296143055`*^9, 
   3.8557359297150106`*^9}, 3.8558913014121323`*^9, 3.9012805347531805`*^9, 
   3.9012806523206306`*^9},
 CellLabel->"In[67]:=",ExpressionUUID->"9e7ddaa3-307e-4dd2-ae62-b79aeaefa225"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"chan", ",", "class", ",", "feat", ",", "dim", ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UDenseNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7462521277782135`*^9, 3.746252137151247*^9}, 
   3.7488686441228127`*^9, {3.7488699979347563`*^9, 3.7488699980450597`*^9}, {
   3.749873446537406*^9, 3.7498734478017707`*^9}, 3.7498746705329823`*^9, 
   3.7498747783759313`*^9, {3.749959938506793*^9, 3.7499599391067953`*^9}, 
   3.7522365719345875`*^9, {3.855735877261625*^9, 3.8557358814467735`*^9}, {
   3.8557359324615393`*^9, 3.8557359325452824`*^9}, {3.8558913046269093`*^9, 
   3.8558913308967595`*^9}, {3.856255640886586*^9, 3.8562556422276297`*^9}, 
   3.9012805347927322`*^9, 3.901280654151574*^9},
 CellLabel->"In[69]:=",ExpressionUUID->"4b5f34bf-287a-4137-9f05-93f897bfd421"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"chan", ",", "class", ",", "feat", ",", "dim", ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<DenseNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7462521277782135`*^9, 3.746252137151247*^9}, 
   3.7488686441228127`*^9, {3.7488699979347563`*^9, 3.7488699980450597`*^9}, {
   3.749873446537406*^9, 3.7498734478017707`*^9}, 3.752236572580288*^9, {
   3.8388693729584975`*^9, 3.8388693735818653`*^9}, 3.8396568199240036`*^9, {
   3.8557359096137285`*^9, 3.8557359359346075`*^9}, {3.8558913120170884`*^9, 
   3.855891314145393*^9}, 3.8562507813003464`*^9, 3.8562508236043*^9, 
   3.8562545012029343`*^9, {3.8562546731867223`*^9, 3.8562546734913483`*^9}, {
   3.8562556436381903`*^9, 3.8562556450129952`*^9}, {3.8562584871682644`*^9, 
   3.8562584874629507`*^9}, 3.901280534807412*^9, 3.90128065593828*^9},
 CellLabel->"In[70]:=",ExpressionUUID->"2dc3f972-5ec6-4802-9dad-d19e96ab1bdf"]
}, Closed]],

Cell[CellGroupData[{

Cell["Show 3D UNET", "Subsection",
 CellChangeTimes->{{3.745075168901682*^9, 3.7450751811326494`*^9}, {
  3.750392396919392*^9, 3.7503923970805225`*^9}, {3.8485644975504436`*^9, 
  3.848564499149523*^9}},ExpressionUUID->"c2c1a71e-7be2-429c-b2b4-\
d117e403cf3c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"dim", "=", 
   RowBox[{"{", 
    RowBox[{"32", ",", "64", ",", "64"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"chan", "=", "2"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"class", "=", "4"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"feat", "=", "8"}], ";"}]}], "Input",
 CellChangeTimes->{{3.749959904969222*^9, 3.749959913431817*^9}, {
  3.8558914807239914`*^9, 3.8558914875220156`*^9}, {3.9012808100684595`*^9, 
  3.9012808171393023`*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"6d339c2b-2d9d-44dd-9e0a-4a0dbeecbfc6"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"chan", ",", "class", ",", "feat", ",", "dim", ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UNET\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.745216488810031*^9, 3.7452165193851957`*^9}, {
   3.7459192848425136`*^9, 3.7459193016397495`*^9}, {3.746252116097231*^9, 
   3.746252123166115*^9}, 3.748869990911284*^9, {3.749959918028756*^9, 
   3.7499599182994757`*^9}, {3.752236566015766*^9, 3.7522365665872755`*^9}, 
   3.855731435692972*^9, 3.8557345688892803`*^9, {3.855736344607382*^9, 
   3.85573634471111*^9}, {3.8558933660161037`*^9, 3.8558933677035594`*^9}, {
   3.856282448833909*^9, 3.8562824505050163`*^9}, 3.8562838893961425`*^9, 
   3.9012805348223605`*^9, 3.901280824218356*^9},
 CellLabel->"In[75]:=",ExpressionUUID->"2e5674ad-0fe3-4174-a86f-90995360b162"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"chan", ",", "class", ",", "feat", ",", "dim", ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UResNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7462521338213315`*^9, {3.7488699945277333`*^9, 3.7488699946229763`*^9}, 
   3.749873564378894*^9, {3.7499599274995117`*^9, 3.7499599278075113`*^9}, 
   3.7522365706070485`*^9, {3.855736349114709*^9, 3.8557363491974535`*^9}, 
   3.855893370876363*^9, 3.9012805348277936`*^9, 3.9012808262023754`*^9},
 CellLabel->"In[76]:=",ExpressionUUID->"5e4eecce-caf9-4cb0-b292-96f4955fe501"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"chan", ",", "class", ",", "feat", ",", "dim", ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<ResNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7462521338213315`*^9, {3.7488699945277333`*^9, 3.7488699946229763`*^9}, {
   3.749959932431128*^9, 3.7499599327791405`*^9}, 3.752236571277831*^9, {
   3.8557363549888496`*^9, 3.855736355091586*^9}, 3.8558933729109497`*^9, 
   3.901280534832341*^9, 3.901280827948481*^9},
 CellLabel->"In[77]:=",ExpressionUUID->"33f4c15b-7088-4cb8-9e81-d426ff056818"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"chan", ",", "class", ",", "feat", ",", "dim", ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UDenseNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7462521277782135`*^9, 3.746252137151247*^9}, 
   3.7488686441228127`*^9, {3.7488699979347563`*^9, 3.7488699980450597`*^9}, {
   3.749873446537406*^9, 3.7498734478017707`*^9}, 3.7498746705329823`*^9, 
   3.7498747783759313`*^9, {3.749959938506793*^9, 3.7499599391067953`*^9}, 
   3.7522365719345875`*^9, {3.855734424489357*^9, 3.855734426361846*^9}, {
   3.855736360766287*^9, 3.855736360870004*^9}, {3.855893376812657*^9, 
   3.855893379207223*^9}, 3.9012805348384476`*^9, {3.901280829593176*^9, 
   3.9012808510218306`*^9}},
 CellLabel->"In[78]:=",ExpressionUUID->"b10a0e6b-4f32-40ae-8896-6f45a3790cde"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"chan", ",", "class", ",", "feat", ",", "dim", ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<DenseNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7462521277782135`*^9, 3.746252137151247*^9}, 
   3.7488686441228127`*^9, {3.7488699979347563`*^9, 3.7488699980450597`*^9}, {
   3.749873446537406*^9, 3.7498734478017707`*^9}, 3.752236572580288*^9, {
   3.8388693729584975`*^9, 3.8388693735818653`*^9}, 3.8396568199240036`*^9, {
   3.8557348506348147`*^9, 3.8557348521846995`*^9}, {3.8557363671827106`*^9, 
   3.855736367266487*^9}, {3.8558933449061456`*^9, 3.855893346167776*^9}, {
   3.8558933833239884`*^9, 3.8558933858641963`*^9}, 3.901280534847787*^9, {
   3.90128083139866*^9, 3.901280860338483*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"ae4bf7b0-fe1c-439e-8188-624c257a1963"]
}, Closed]],

Cell[CellGroupData[{

Cell["Describe UNET", "Subsection",
 CellChangeTimes->{{3.745075168901682*^9, 3.7450751811326494`*^9}, {
  3.7462521442250814`*^9, 
  3.746252151356104*^9}},ExpressionUUID->"76f5f44a-4849-492f-91b6-\
2840ffd5e759"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "general", "*)"}], " ", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nets", "=", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Unet\>\"", ",", " ", "\"\<UResNet\>\"", ",", " ", "\"\<ResNet\>\"",
        ",", " ", "\"\<UDenseNet\>\"", ",", " ", "\"\<DenseNet\>\""}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"style", "=", 
     RowBox[{"{", 
      RowBox[{"Bold", ",", 
       RowBox[{"TextAlignment", "\[Rule]", "Center"}], ",", 
       RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "}"}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"lab", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"#", ",", "style"}], "]"}], "&"}], "/@", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"{", "\"\<features\>\"", "}"}], ",", "nets"}], "]"}]}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"CountConv", "=", 
     RowBox[{
      RowBox[{"Count", "[", 
       RowBox[{
        RowBox[{"Head", "/@", 
         RowBox[{"Information", "[", 
          RowBox[{"#", ",", "\"\<LayersList\>\""}], "]"}]}], ",", 
        "ConvolutionLayer"}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "parameters", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim3D", "=", 
     RowBox[{"{", 
      RowBox[{"32", ",", "64", ",", "64"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim2D", "=", 
     RowBox[{"Drop", "[", 
      RowBox[{"dim3D", ",", "1"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nchan", ",", "nclass"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", "8"}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"dep", "=", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "8", ",", "16", ",", "24", ",", "32"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"par", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"dep", "[", 
         RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "dep", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.745320645743224*^9, 3.745320689164191*^9}, {
   3.7453207467766867`*^9, 3.745320748332337*^9}, {3.7499590656706057`*^9, 
   3.7499590766482816`*^9}, {3.750238154926571*^9, 3.7502381565027323`*^9}, {
   3.750238196582364*^9, 3.7502382007855473`*^9}, {3.75023838646856*^9, 
   3.7502383866269803`*^9}, 3.750254859891078*^9, {3.855736389036441*^9, 
   3.8557363955153723`*^9}, 3.8557364261553483`*^9, {3.856255721327817*^9, 
   3.8562557217341704`*^9}, 3.856255779013777*^9, {3.856255950536001*^9, 
   3.85625600675217*^9}, {3.856256196649811*^9, 3.856256196694838*^9}, {
   3.8562677342253623`*^9, 3.856267739480961*^9}, {3.8562841023238783`*^9, 
   3.8562841056748276`*^9}, {3.901280907355075*^9, 3.9012809083385253`*^9}},
 CellLabel->"In[80]:=",ExpressionUUID->"7f5059a8-2613-4aa5-a092-89b68762a5b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"2", "D", " ", "UNET", " ", "generation"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"par2D", ",", "mem2D"}], "}"}], "=", 
     RowBox[{"Transpose", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"nets2D", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"MakeUNET", "[", 
             RowBox[{"nchan", ",", "nclass", ",", " ", 
              RowBox[{"dep", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", " ", "dim2D", ",", " ", 
              RowBox[{"BlockType", "\[Rule]", "#"}]}], " ", "]"}], "&"}], "/@",
            "nets"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Information", "[", 
                 RowBox[{"#", ",", "\"\<ArraysTotalElementCount\>\""}], "]"}],
                 "&"}], "/@", "nets2D"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Information", "[", 
                 RowBox[{"#", ",", "\"\<ArraysTotalByteCount\>\""}], "]"}], 
                "&"}], "/@", "nets2D"}]}], "}"}]}]}], "\[IndentingNewLine]", 
          "}"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "dep", "]"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"layers2D", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"CountConv", "[", "#", "]"}], "]"}], "&"}], "/@", 
      "nets2D"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.745075188567417*^9, 3.7450751899881926`*^9}, {
   3.7450752456030893`*^9, 3.7450752725005655`*^9}, {3.74507534392449*^9, 
   3.7450753464010396`*^9}, {3.745118023019107*^9, 3.7451183513110027`*^9}, {
   3.7451201237098413`*^9, 3.745120126132266*^9}, {3.7451204912112007`*^9, 
   3.745120497773902*^9}, {3.745135390604102*^9, 3.7451353908914146`*^9}, 
   3.7451354277237024`*^9, {3.7453206689877005`*^9, 3.745320696907543*^9}, {
   3.745742877386057*^9, 3.7457429041682653`*^9}, {3.7457429389535522`*^9, 
   3.7457430208882217`*^9}, {3.7457430565855417`*^9, 3.745743092650964*^9}, 
   3.745743123690982*^9, 3.7457434253459444`*^9, {3.7457434709599953`*^9, 
   3.74574347111541*^9}, 3.7457437027188053`*^9, {3.7457437692771034`*^9, 
   3.745743774731105*^9}, {3.745743878350533*^9, 3.7457439084439263`*^9}, 
   3.745744029388075*^9, 3.749473670678999*^9, {3.749473751990258*^9, 
   3.7494737821808043`*^9}, {3.749473872258727*^9, 3.7494738913933372`*^9}, {
   3.749873616386285*^9, 3.7498736518696966`*^9}, {3.749921137352709*^9, 
   3.749921159232922*^9}, {3.749921219330812*^9, 3.7499212734808807`*^9}, {
   3.749921548750867*^9, 3.7499215509707413`*^9}, 3.749921649801681*^9, {
   3.7499594728524704`*^9, 3.7499595208906574`*^9}, {3.749960485275803*^9, 
   3.749960506608807*^9}, {3.7502371021382303`*^9, 3.750237117059963*^9}, {
   3.750237209682354*^9, 3.7502372441731186`*^9}, {3.7502372864325504`*^9, 
   3.7502373027218857`*^9}, 3.75023734231623*^9, {3.750237441333665*^9, 
   3.750237447759762*^9}, {3.750237532961443*^9, 3.750237651183977*^9}, {
   3.7502377263011756`*^9, 3.7502377926496944`*^9}, 3.750237909933755*^9, {
   3.7502379720540037`*^9, 3.750237979928994*^9}, {3.750238073582121*^9, 
   3.750238074189771*^9}, {3.7502381223528757`*^9, 3.7502381224581947`*^9}, {
   3.7502382034055176`*^9, 3.7502382159078183`*^9}, {3.750238311479049*^9, 
   3.750238340175428*^9}, {3.7502384040352964`*^9, 3.75023840725386*^9}, {
   3.7502384417075243`*^9, 3.7502384459117093`*^9}, 3.75039231907106*^9, 
   3.7522365758560705`*^9, 3.838869521617669*^9, {3.856255715496416*^9, 
   3.8562557428392105`*^9}, {3.856255799420109*^9, 3.856255802776002*^9}, {
   3.856255868278541*^9, 3.856255872406766*^9}, {3.8562559350812016`*^9, 
   3.8562559365085635`*^9}, {3.856256021070299*^9, 3.856256048506939*^9}, {
   3.901251884132275*^9, 3.9012519125571136`*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"b761a02b-0a72-4ab9-963b-f19b4aeedd21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"3", "D", " ", "UNET", " ", "generation"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"par3D", ",", "mem3D"}], "}"}], "=", 
     RowBox[{"Transpose", "@", 
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"nets3D", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"MakeUNET", "[", 
             RowBox[{"nchan", ",", "nclass", ",", " ", 
              RowBox[{"dep", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "dim3D", ",", 
              RowBox[{"BlockType", "\[Rule]", "#"}]}], " ", "]"}], "&"}], "/@",
            "nets"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Information", "[", 
                 RowBox[{"#", ",", "\"\<ArraysTotalElementCount\>\""}], "]"}],
                 "&"}], "/@", "nets3D"}]}], "}"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"par", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Information", "[", 
                 RowBox[{"#", ",", "\"\<ArraysTotalByteCount\>\""}], "]"}], 
                "&"}], "/@", "nets3D"}]}], "}"}]}]}], "\[IndentingNewLine]", 
          "}"}]}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", "dep", "]"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"layers3D", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ToString", "[", 
        RowBox[{"CountConv", "[", "#", "]"}], "]"}], "&"}], "/@", 
      "nets3D"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.745075188567417*^9, 3.7450751899881926`*^9}, {
   3.7450752456030893`*^9, 3.7450752725005655`*^9}, {3.74507534392449*^9, 
   3.7450753464010396`*^9}, {3.745118023019107*^9, 3.7451182447236233`*^9}, {
   3.745118275382165*^9, 3.745118277876796*^9}, {3.7451183562411404`*^9, 
   3.745118356884856*^9}, {3.745118588692522*^9, 3.745118593005641*^9}, {
   3.7451205027119074`*^9, 3.745120511069149*^9}, {3.745135378920534*^9, 
   3.745135408761692*^9}, {3.745320698684863*^9, 3.745320707689217*^9}, {
   3.74574349284871*^9, 3.745743593673278*^9}, {3.7457437065550375`*^9, 
   3.745743707147167*^9}, 3.7457437813548136`*^9, {3.7457439305559254`*^9, 
   3.7457439402977514`*^9}, {3.745744036234914*^9, 3.7457440511346035`*^9}, 
   3.745744114798486*^9, {3.7457442005089407`*^9, 3.7457442041853065`*^9}, {
   3.749960075911649*^9, 3.7499602697624407`*^9}, 3.749960379443901*^9, {
   3.7499604099309645`*^9, 3.749960411818965*^9}, 3.7499605119880075`*^9, 
   3.7502371276110015`*^9, {3.7502373127605953`*^9, 3.750237341494042*^9}, {
   3.7502378068584995`*^9, 3.750237932596025*^9}, {3.7502379814520063`*^9, 
   3.75023798451118*^9}, {3.7502380781111994`*^9, 3.750238078970457*^9}, 
   3.7502381316676702`*^9, {3.7502382198933926`*^9, 3.750238222725957*^9}, 
   3.75023841584271*^9, {3.750238448007309*^9, 3.750238449968502*^9}, {
   3.7503923144578133`*^9, 3.7503923221451764`*^9}, 3.752236577246789*^9, {
   3.8388697823357134`*^9, 3.8388697840905943`*^9}, {3.856255816331112*^9, 
   3.856255877894685*^9}, {3.8562559407445774`*^9, 3.8562559410251245`*^9}, {
   3.856256039968042*^9, 3.856256047327386*^9}, {3.901251821568817*^9, 
   3.901251837959927*^9}, 3.9012518785600204`*^9, 3.9012519190860558`*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"aed1bab8-edac-4d92-9541-4eccb772481b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "Table"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"layers", "=", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Number of convolution layers\>\"", ",", "style"}], 
          "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"\"\<1)  UNet: \>\"", "<>", 
            RowBox[{"layers2D", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", 
            "\"\<    2)  UResNet: \>\"", "<>", 
            RowBox[{"layers2D", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "<>", "\[IndentingNewLine]", 
            "\"\<    3)  ResNet: \>\"", "<>", 
            RowBox[{"layers2D", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "<>", 
            "\"\<    4)  UDenseNet: \>\"", "<>", 
            RowBox[{"layers2D", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "<>", 
            "\"\<    5)  DenseNet: \>\"", "<>", 
            RowBox[{"layers2D", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "style"}], "]"}]}], "}"}],
        ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tab1", "=", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<2D Nets - Numer of Array Elementes\>\"", ",", "style"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"TableForm", "[", 
          RowBox[{"par2D", ",", 
           RowBox[{"TableHeadings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", "lab"}], "}"}]}], ",", 
           RowBox[{"TableAlignments", "\[Rule]", "Right"}]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tab2", "=", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<3D Nets - Numer of Array Elementes\>\"", ",", "style"}], "]"}],
          ",", "\[IndentingNewLine]", 
         RowBox[{"TableForm", "[", 
          RowBox[{"par3D", ",", 
           RowBox[{"TableHeadings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", "lab"}], "}"}]}], ",", 
           RowBox[{"TableAlignments", "\[Rule]", "Right"}]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "layers", ",", "\"\<\>\"", ",", "tab1", ",", "\"\<\>\"", ",", "tab2"}], 
      "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.838869959173149*^9, 3.8388699916486235`*^9}, 
   3.8388725663073015`*^9, {3.8562558874128127`*^9, 3.856255888168082*^9}, {
   3.856256023638771*^9, 3.856256061704873*^9}},
 CellLabel->"In[93]:=",ExpressionUUID->"13c62ff2-efd8-49ab-9e9d-4cee405fe2c5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "Table"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"layers", "=", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<Number of convolution layers\>\"", ",", "style"}], 
          "]"}], ",", 
         RowBox[{"Style", "[", 
          RowBox[{
           RowBox[{"\"\<1)  UNet: \>\"", "<>", 
            RowBox[{"layers2D", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "<>", 
            "\"\<    2)  UResNet: \>\"", "<>", 
            RowBox[{"layers2D", "[", 
             RowBox[{"[", "2", "]"}], "]"}], "<>", "\[IndentingNewLine]", 
            "\"\<    3)  ResNet: \>\"", "<>", 
            RowBox[{"layers2D", "[", 
             RowBox[{"[", "3", "]"}], "]"}], "<>", 
            "\"\<    4)  UDenseNet: \>\"", "<>", 
            RowBox[{"layers2D", "[", 
             RowBox[{"[", "4", "]"}], "]"}], "<>", 
            "\"\<    5)  DenseNet: \>\"", "<>", 
            RowBox[{"layers2D", "[", 
             RowBox[{"[", "5", "]"}], "]"}]}], ",", "style"}], "]"}]}], "}"}],
        ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tab1", "=", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<2D Nets - Numer of Array bytes\>\"", ",", "style"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TableForm", "[", 
          RowBox[{"mem2D", ",", 
           RowBox[{"TableHeadings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", "lab"}], "}"}]}], ",", 
           RowBox[{"TableAlignments", "\[Rule]", "Right"}]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tab2", "=", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<3D Nets - Numer of Array bytes\>\"", ",", "style"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"TableForm", "[", 
          RowBox[{"mem3D", ",", 
           RowBox[{"TableHeadings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", "lab"}], "}"}]}], ",", 
           RowBox[{"TableAlignments", "\[Rule]", "Right"}]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "layers", ",", "\"\<\>\"", ",", "tab1", ",", "\"\<\>\"", ",", "tab2"}], 
      "}"}], ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.9012809544582796`*^9, 3.901280972568441*^9}, 
   3.901281059349163*^9},
 CellLabel->"In[97]:=",ExpressionUUID->"4cb80908-6117-4edc-a469-e3c9fc57b616"]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples of Test Data", "Subsection",
 CellChangeTimes->{{3.7362393807238426`*^9, 3.736239385696301*^9}, {
  3.736781314388665*^9, 
  3.7367813242900867`*^9}},ExpressionUUID->"82f847f8-af86-4335-b010-\
0b525865d7eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", ",", "label"}], "}"}], "=", 
   RowBox[{"CreateImage1", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MakeChannelImage", "[", "data", "]"}], ",", 
    RowBox[{"Image", "[", "label", "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{
  3.7367816504903927`*^9, {3.7367817167059765`*^9, 3.736781727658814*^9}, {
   3.736927652949238*^9, 3.7369276814355545`*^9}, 3.7369277130361896`*^9},
 CellLabel->
  "In[109]:=",ExpressionUUID->"836a86c0-c7ac-4ccb-bfdc-9ed48356a9a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", ",", "label"}], "}"}], "=", 
   RowBox[{"CreateImage2", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MakeChannelImage", "[", "data", "]"}], ",", 
    RowBox[{"MakeClassImage", "[", "label", "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.736781467769794*^9, 3.7367814997244406`*^9}, {
  3.736781629243444*^9, 3.736781640301976*^9}, {3.736781711889228*^9, 
  3.7367817338639455`*^9}, {3.7369276713783712`*^9, 3.736927717853346*^9}},
 CellLabel->
  "In[111]:=",ExpressionUUID->"68d492e8-df7c-44dd-bd79-7202d31beee2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", ",", "label"}], "}"}], "=", 
   RowBox[{"CreateImage3", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MakeChannelImage", "[", "data", "]"}], ",", 
    RowBox[{"MakeClassImage", "[", 
     RowBox[{"label", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "4"}], "}"}]}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.736781687566295*^9, 3.7367817370508847`*^9}, {
  3.7367819602502584`*^9, 3.736781962830623*^9}, {3.736927722362133*^9, 
  3.736927735750816*^9}},
 CellLabel->
  "In[113]:=",ExpressionUUID->"f0cb3ed1-b97f-4cd2-8a80-5c47ebc56121"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", ",", "label"}], "}"}], "=", 
   RowBox[{"CreateImage4", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MakeChannelImage", "[", "data", "]"}], ",", 
    RowBox[{"MakeClassImage", "[", 
     RowBox[{"label", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "4"}], "}"}]}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.7367818340732017`*^9, 3.7367818582521353`*^9}, {
   3.736781934422789*^9, 3.7367819371755004`*^9}, 3.7369277457844744`*^9},
 CellLabel->
  "In[115]:=",ExpressionUUID->"970c22ac-cfcc-428b-a387-451a782d95b5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Cases 1: 1 channel - 1 classes", "Subsection",
 CellChangeTimes->{{3.7362393923808303`*^9, 3.736239395951547*^9}, {
   3.7362558963969927`*^9, 3.7362558973125873`*^9}, {3.73692725042663*^9, 
   3.736927264403715*^9}, 
   3.7369312394201775`*^9},ExpressionUUID->"f0a4d34d-373a-4eff-a8eb-\
07e59aabf187"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "test", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data1", ",", "label1"}], "}"}], "=", 
    RowBox[{"MakeTestImages", "[", 
     RowBox[{"100", ",", "1"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736223942920128*^9, 3.736223950732706*^9}, {
  3.7362240856355734`*^9, 3.736224145327012*^9}, {3.736927241127551*^9, 
  3.7369272478575377`*^9}, {3.736927362836816*^9, 3.736927368244885*^9}, {
  3.7390080753894987`*^9, 3.7390080757705173`*^9}},
 CellLabel->
  "In[117]:=",ExpressionUUID->"5f25cc7b-42de-4d1f-a5d8-82a79441e73b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"split", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "train1", ",", "valid1", ",", "testData1", ",", "testLabel1", ",", 
      "order1"}], "}"}], "=", 
    RowBox[{"SplitTrainData", "[", 
     RowBox[{"data1", ",", "label1"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736092162506568*^9, 3.7360921717151403`*^9}, {
   3.736093115569694*^9, 3.7360931493970985`*^9}, {3.7360962453078156`*^9, 
   3.7360962816214952`*^9}, {3.736097265636952*^9, 3.7360972662181053`*^9}, {
   3.7361427730684586`*^9, 3.736142786967091*^9}, {3.7361429395526505`*^9, 
   3.7361429399367094`*^9}, {3.7361456385354853`*^9, 3.736145647773047*^9}, {
   3.7361457940966015`*^9, 3.7361458003489246`*^9}, {3.7361479807772937`*^9, 
   3.7361480001513195`*^9}, {3.7361484779289703`*^9, 
   3.7361484874693284`*^9}, {3.736151167964548*^9, 3.736151214340464*^9}, {
   3.736152584980132*^9, 3.736152616490549*^9}, 3.7361529074294634`*^9, 
   3.7361529566400914`*^9, {3.7361531197438593`*^9, 3.73615313179025*^9}, {
   3.7361600789237127`*^9, 3.7361600813580875`*^9}, {3.7361635050115585`*^9, 
   3.736163533463912*^9}, {3.7361644334553747`*^9, 3.7361644338057575`*^9}, {
   3.7362279790764766`*^9, 3.736228032270702*^9}, {3.7362328390168405`*^9, 
   3.7362328408694506`*^9}, {3.736412016557328*^9, 3.736412022914005*^9}, 
   3.7364815312103825`*^9, {3.736481683859022*^9, 3.7364816839823465`*^9}, 
   3.736481815843889*^9, {3.7364825364840155`*^9, 3.7364825453440647`*^9}, {
   3.736482891849559*^9, 3.736482891923483*^9}, {3.736484323508561*^9, 
   3.7364843268249426`*^9}, {3.7364847645303087`*^9, 3.7364847665183306`*^9}, 
   3.7364920191692405`*^9, {3.7364921657699795`*^9, 3.736492165826701*^9}, 
   3.7366673012154317`*^9, {3.73666809453461*^9, 3.7366680946048284`*^9}, 
   3.736782097103197*^9, {3.7367850183587008`*^9, 3.736785025066718*^9}, {
   3.736785061322934*^9, 3.7367850853556614`*^9}, 3.7368517584156976`*^9, {
   3.7368582990044003`*^9, 3.7368583560863895`*^9}, 3.736858526716897*^9, {
   3.7368586492008877`*^9, 3.736858717129797*^9}, {3.7368588001858063`*^9, 
   3.736858866458607*^9}, {3.736858940179243*^9, 3.7368589465502214`*^9}, {
   3.7368589924764147`*^9, 3.736859014101614*^9}, {3.736859046262355*^9, 
   3.736859052569999*^9}, {3.736859351801052*^9, 3.7368593659443073`*^9}, {
   3.7368663005171733`*^9, 3.73686630068001*^9}, 3.736866400802652*^9, {
   3.736866465417356*^9, 3.7368664673121133`*^9}, {3.73686669834263*^9, 
   3.7368667009804106`*^9}, {3.7368668401080923`*^9, 
   3.7368668409069796`*^9}, {3.736866886407938*^9, 3.736866893403507*^9}, {
   3.7368671253434277`*^9, 3.736867125435185*^9}, {3.7368672774770947`*^9, 
   3.7368672851343465`*^9}, {3.736917535059682*^9, 3.736917536516204*^9}, {
   3.7369320881153126`*^9, 3.7369321217600565`*^9}, {3.73693215928226*^9, 
   3.7369321697090592`*^9}, {3.7379939438160057`*^9, 
   3.7379939521298113`*^9}, {3.745920911853548*^9, 3.7459209167496386`*^9}, {
   3.866180378821994*^9, 3.8661803892224164`*^9}},
 CellLabel->
  "In[118]:=",ExpressionUUID->"a8cd47fa-548c-447b-ad56-a6db4a07fd36"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"train", " ", "the", " ", "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"net1", ",", "trained1", ",", "netTrained1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"result1", ",", "iou1"}], "}"}]}], "}"}], "=", 
     RowBox[{"TrainUNET", "[", 
      RowBox[{"train1", ",", "valid1", ",", 
       RowBox[{"{", 
        RowBox[{"testData1", ",", "testLabel1"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TargetDevice", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<GPU\>\"", ",", "1"}], "}"}]}], ",", 
       RowBox[{"MaxTrainingRounds", "\[Rule]", "250"}], ",", 
       RowBox[{"NetParameters", "\[Rule]", "2"}], ",", 
       RowBox[{"DropoutRate", "\[Rule]", ".5"}], ",", 
       RowBox[{"BatchSize", "\[Rule]", "32"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MakeNetPlots", "[", "trained1", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.736421957082659*^9, {3.7364787021657953`*^9, 3.736478710954377*^9}, {
   3.736481023645641*^9, 3.736481032731614*^9}, 3.736481294607136*^9, {
   3.73648436196591*^9, 3.736484371040115*^9}, {3.736484494879651*^9, 
   3.736484508232232*^9}, {3.736492049823741*^9, 3.736492049933117*^9}, 
   3.7366641414270287`*^9, {3.736666630235386*^9, 3.7366666326731224`*^9}, {
   3.736666665921709*^9, 3.7366666659842043`*^9}, {3.736782069126108*^9, 
   3.7367820714276886`*^9}, {3.736782131535329*^9, 3.736782138593763*^9}, {
   3.7367840948657007`*^9, 3.736784122051338*^9}, {3.736784369340965*^9, 
   3.736784370450262*^9}, 3.7368509842315054`*^9, {3.7368510297748404`*^9, 
   3.73685103357183*^9}, {3.736851069291587*^9, 3.7368510698386474`*^9}, 
   3.7369272841698074`*^9, {3.7369273829543734`*^9, 3.736927419357041*^9}, {
   3.736927452589646*^9, 3.7369274718429365`*^9}, {3.7369309871479635`*^9, 
   3.7369309972670712`*^9}, {3.7390076318144403`*^9, 
   3.7390076318790383`*^9}, {3.7390078119937935`*^9, 3.739007812085964*^9}, 
   3.739007968364256*^9, {3.73900800500515*^9, 3.739008007593692*^9}, 
   3.7390081683841963`*^9, {3.745050960782175*^9, 3.745050964377982*^9}, {
   3.7450552393979287`*^9, 3.745055291962062*^9}, {3.7450599001073074`*^9, 
   3.7450599113207164`*^9}, {3.7458380180867214`*^9, 
   3.7458380181849833`*^9}, {3.7459193161712837`*^9, 3.745919328393549*^9}, 
   3.848566022111797*^9, {3.848566052169479*^9, 3.8485660532386613`*^9}, {
   3.8485661015421906`*^9, 3.8485661051604867`*^9}, 3.8557374298089223`*^9, {
   3.85573759071906*^9, 3.855737594992553*^9}, 3.855894986542118*^9, {
   3.866006388694396*^9, 3.8660063892048855`*^9}, {3.8660064664867597`*^9, 
   3.8660064736675367`*^9}, {3.8660066587734256`*^9, 
   3.8660066593478684`*^9}, {3.8661802245085287`*^9, 3.8661802267912464`*^9}, 
   3.86618025887038*^9, 3.901280534907284*^9},
 CellLabel->
  "In[119]:=",ExpressionUUID->"e628eb92-cfc7-44bc-8c58-0ac81605d1ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "layers", " ", "of", " ", "the", " ", 
    "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"VisualizeUNET2D", "[", 
   RowBox[{"testData1", ",", "netTrained1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7367635744536123`*^9, 3.736763586834174*^9}, {
   3.736764000182431*^9, 3.7367640089543753`*^9}, 3.7367643725344725`*^9, {
   3.7367652678051596`*^9, 3.7367652681687517`*^9}, {3.736782988251666*^9, 
   3.7367829947281933`*^9}, {3.7367832730906196`*^9, 3.736783273431922*^9}, {
   3.736929754722163*^9, 3.7369297662008657`*^9}, 3.7390059276441746`*^9, 
   3.7390077206752834`*^9},
 CellLabel->
  "In[121]:=",ExpressionUUID->"18a352a1-5023-43ff-8324-5c2f5303f12b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "test", " ", "data", " ", "witout", " ", 
    "diff", " ", "image"}], "*)"}], "\n", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData1", ",", "testLabel1", ",", "result1", ",", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "3"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.736927413966957*^9, 3.7369274161629543`*^9}, {
   3.736927886167271*^9, 3.7369278959829507`*^9}, {3.736928059326234*^9, 
   3.7369280621129756`*^9}, {3.7369310203321457`*^9, 
   3.7369310222404804`*^9}, {3.745837930260993*^9, 3.745837938018444*^9}, 
   3.866025062776477*^9},
 CellLabel->
  "In[122]:=",ExpressionUUID->"b0544004-dc84-4858-852b-930cdc49ac1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "test", " ", "data", " ", "with", " ", 
    "diff", " ", "image"}], "*)"}], "\n", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData1", ",", "testLabel1", ",", "result1", ",", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "3"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.736927413966957*^9, 3.7369274161629543`*^9}, {
   3.736927886167271*^9, 3.7369278959829507`*^9}, {3.736928059326234*^9, 
   3.736928085569493*^9}, {3.7369281526312003`*^9, 3.7369281551249776`*^9}, {
   3.7369310297366257`*^9, 3.736931032258111*^9}, 3.8660250706492343`*^9},
 CellLabel->
  "In[123]:=",ExpressionUUID->"d42a3795-8587-44e7-897d-9edcd48c49eb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Case 2: 1 channel - 2 classes", "Subsection",
 CellChangeTimes->{{3.7362559025269456`*^9, 3.7362559070878487`*^9}, {
   3.736927271462489*^9, 3.7369272795614557`*^9}, 
   3.736931238649115*^9},ExpressionUUID->"ae8a8131-f090-4256-99d8-\
202947e3efc1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "test", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data2", ",", "label2"}], "}"}], "=", 
    RowBox[{"MakeTestImages", "[", 
     RowBox[{"100", ",", "2"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736223942920128*^9, 3.736223950732706*^9}, {
   3.7362240856355734`*^9, 3.736224155216504*^9}, 3.736227983792309*^9, {
   3.736929696262554*^9, 3.736929697022158*^9}, {3.736929732032507*^9, 
   3.736929732126422*^9}, {3.7450516089183645`*^9, 3.7450516092863464`*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"b5a917a9-f063-4532-b914-d9977b90bb50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"split", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "train2", ",", "valid2", ",", "testData2", ",", "testLabel2", ",", 
      "order"}], "}"}], "=", 
    RowBox[{"SplitTrainData", "[", 
     RowBox[{"data2", ",", "label2"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7369297075753202`*^9, 3.736929708218224*^9}, {
  3.7369301009356327`*^9, 3.7369301039153814`*^9}, {3.745838615322497*^9, 
  3.745838616068084*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"7d59c487-cc4e-4c58-95d2-35721084a132"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"train", " ", "the", " ", "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"net2", ",", "trained2", ",", "netTrained2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"result2", ",", "iou2"}], "}"}]}], "}"}], "=", 
     RowBox[{"TrainUNET", "[", 
      RowBox[{"train2", ",", "valid2", ",", 
       RowBox[{"{", 
        RowBox[{"testData2", ",", "testLabel2"}], "}"}], ",", 
       RowBox[{"BatchSize", "->", "32"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TargetDevice", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<GPU\>\"", ",", "1"}], "}"}]}], ",", 
       RowBox[{"MaxTrainingRounds", "\[Rule]", "250"}], ",", 
       RowBox[{"NetParameters", "\[Rule]", "2"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AugmentTrainData", "->", 
        RowBox[{"{", 
         RowBox[{"False", ",", "False", ",", "True"}], "}"}]}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"MakeNetPlots", "[", "trained2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.736784749064206*^9, 3.7367847495978036`*^9}, 
   3.7368431144347076`*^9, 3.7368431721095114`*^9, 3.7368432362104325`*^9, {
   3.7368511308398733`*^9, 3.7368511312771254`*^9}, {3.7369296993855*^9, 
   3.7369297234740033`*^9}, {3.7369298003682275`*^9, 3.736929800665102*^9}, {
   3.7369301057657566`*^9, 3.7369301191445885`*^9}, {3.745051626780969*^9, 
   3.745051639925393*^9}, {3.745059907337956*^9, 3.745059914696717*^9}, {
   3.745838585461971*^9, 3.7458385855366793`*^9}, {3.7459193842182665`*^9, 
   3.7459193858990383`*^9}, {3.7459197887156353`*^9, 
   3.7459197926491585`*^9}, {3.8485668908278275`*^9, 3.848566921966338*^9}, {
   3.8522854556646423`*^9, 3.852285455783323*^9}, {3.8522858786430445`*^9, 
   3.852285885125492*^9}, {3.8522859419003057`*^9, 3.852285946568147*^9}, {
   3.852286116353281*^9, 3.8522861674400163`*^9}, {3.852286644631749*^9, 
   3.852286675035739*^9}, {3.852286804698572*^9, 3.852286811720993*^9}, {
   3.8557377923704033`*^9, 3.855737792432255*^9}, {3.8558956418249245`*^9, 
   3.8558956476473446`*^9}, {3.855903955133541*^9, 3.8559039677567644`*^9}, {
   3.855906991451067*^9, 3.8559069948398943`*^9}, {3.8559070258665886`*^9, 
   3.8559070262978873`*^9}, 3.8559097766562777`*^9, {3.856250731480755*^9, 
   3.8562507539125967`*^9}, {3.856250836517136*^9, 3.8562508409473104`*^9}, {
   3.8562585632157965`*^9, 3.8562585660157022`*^9}, 3.8562677130354877`*^9, 
   3.856267837344932*^9, {3.856267929485639*^9, 3.85626794773327*^9}, 
   3.901280534917574*^9, 3.9013300655165234`*^9},
 CellLabel->
  "In[131]:=",ExpressionUUID->"e011104e-23ba-49d9-89cd-0622d4202e2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "layers", " ", "of", " ", "the", " ", 
    "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"VisualizeUNET2D", "[", 
   RowBox[{"testData2", ",", "netTrained2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7367635744536123`*^9, 3.736763586834174*^9}, {
   3.736764000182431*^9, 3.7367640089543753`*^9}, 3.7367643725344725`*^9, {
   3.7367652678051596`*^9, 3.7367652681687517`*^9}, {3.736782988251666*^9, 
   3.7367829947281933`*^9}, {3.7367832730906196`*^9, 3.736783273431922*^9}, {
   3.7369297743840933`*^9, 3.736929775185273*^9}, {3.7369301258744745`*^9, 
   3.736930130414729*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"eba55e35-2f18-4a6f-9d99-93a7d09cf581"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "test", " ", "data", " ", "witout", " ", 
    "diff", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData2", ",", " ", "testLabel2", ",", "result2", ",", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "3"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "True"}], ",", 
    RowBox[{"ClassStepSize", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.736663921832626*^9, 3.736663933539857*^9}, {
   3.7366666492813053`*^9, 3.736666649468827*^9}, {3.736666724079117*^9, 
   3.736666724157335*^9}, 3.7367820920110397`*^9, {3.7367827322697463`*^9, 
   3.736782741183428*^9}, {3.736784677305621*^9, 3.736784679932448*^9}, {
   3.7369297985876594`*^9, 3.736929819951904*^9}, {3.7369301267761793`*^9, 
   3.736930138221402*^9}, {3.7450517386157637`*^9, 3.7450517391071434`*^9}, {
   3.8661807656810265`*^9, 3.8661807693690352`*^9}},
 CellLabel->
  "In[134]:=",ExpressionUUID->"25af0373-c2c0-46f7-bf72-f026e1a97ed9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Case 3: 1 channel - 4 classes", "Subsection",
 CellChangeTimes->{{3.7362559139392004`*^9, 3.7362559217185698`*^9}, {
  3.7364111182974825`*^9, 3.7364111208781576`*^9}, {3.7369312255927057`*^9, 
  3.736931234575971*^9}},ExpressionUUID->"07eca103-b55f-49fe-a389-\
80f1a5adc8a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "test", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data3", ",", "label3"}], "}"}], "=", 
    RowBox[{"MakeTestImages", "[", 
     RowBox[{"200", ",", "3"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736223942920128*^9, 3.736223950732706*^9}, {
   3.7362240856355734`*^9, 3.736224155216504*^9}, {3.736227983792309*^9, 
   3.7362279930816565`*^9}, 3.736231119422229*^9, {3.736233288896597*^9, 
   3.736233289263381*^9}, {3.736234179823323*^9, 3.7362341801982365`*^9}, {
   3.736234980977395*^9, 3.7362349812326527`*^9}, {3.736236837028271*^9, 
   3.7362368376220875`*^9}, {3.7362374690219507`*^9, 
   3.7362374694907565`*^9}, {3.7362653551800127`*^9, 3.736265365468457*^9}, {
   3.736334131914491*^9, 3.7363341325211687`*^9}, {3.7364108303651233`*^9, 
   3.736410831114983*^9}, {3.7364114350821204`*^9, 3.7364114357890396`*^9}, {
   3.736479711857704*^9, 3.7364797136401186`*^9}, {3.7367584223632197`*^9, 
   3.7367584227072926`*^9}, {3.7367613999992657`*^9, 3.736761400202159*^9}, {
   3.7369298528488345`*^9, 3.736929854023517*^9}, {3.736929886623393*^9, 
   3.7369298871880236`*^9}, {3.7369299495873294`*^9, 
   3.7369299499073954`*^9}, {3.7369325989609065`*^9, 
   3.7369325990081325`*^9}, {3.739009143228804*^9, 3.739009143594188*^9}, {
   3.7451420078097367`*^9, 3.7451420081267934`*^9}, {3.85573797923942*^9, 
   3.8557379795525756`*^9}, {3.8559079801456237`*^9, 3.8559079805412116`*^9}},
 CellLabel->
  "In[135]:=",ExpressionUUID->"559b218e-8545-4e88-8a6a-59431ce4a153"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"split", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "train3", ",", "valid3", ",", "testData3", ",", "testLabel3", ",", 
      "order3"}], "}"}], "=", 
    RowBox[{"SplitTrainData", "[", 
     RowBox[{"data3", ",", "label3"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736784889974166*^9, 3.7367849429111147`*^9}, 
   3.736843395572187*^9, 3.7368436210199814`*^9, 3.736843696045906*^9, {
   3.7368512327918215`*^9, 3.73685123346352*^9}, {3.736855011806996*^9, 
   3.73685501202577*^9}, {3.7369298591060915`*^9, 3.7369298663299513`*^9}, {
   3.7369309674995594`*^9, 3.736930969569811*^9}, {3.736931039580819*^9, 
   3.736931043628154*^9}, {3.7369312932818484`*^9, 3.7369313131162806`*^9}, {
   3.745142002115037*^9, 3.7451420037120447`*^9}, {3.7458376897339168`*^9, 
   3.745837691011326*^9}, {3.85228467543563*^9, 3.8522846761796427`*^9}, {
   3.855895797236247*^9, 3.8558958010823803`*^9}, 3.8559039387014437`*^9},
 CellLabel->
  "In[136]:=",ExpressionUUID->"60d35187-9ae0-44fc-bb7e-d20386da86c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"train", " ", "the", " ", "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"net3", ",", "trained3", ",", "netTrained3"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"result3", ",", "iou3"}], "}"}]}], "}"}], "=", 
     RowBox[{"TrainUNET", "[", 
      RowBox[{"train3", ",", "valid3", ",", 
       RowBox[{"{", 
        RowBox[{"testData3", ",", "testLabel3"}], "}"}], ",", 
       RowBox[{"BatchSize", "\[Rule]", "32"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TargetDevice", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<GPU\>\"", ",", "1"}], "}"}]}], ",", 
       RowBox[{"MaxTrainingRounds", "\[Rule]", "500"}], ",", 
       RowBox[{"NetParameters", "\[Rule]", "32"}], ",", "\[IndentingNewLine]", 
       RowBox[{"AugmentTrainData", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<90\>\"", ",", "False", ",", "True"}], "}"}]}], ",", 
       RowBox[{"BlockType", "\[Rule]", "\"\<ResNet\>\""}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MakeNetPlots", "[", "trained3", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.736929877040193*^9, 3.736929882687579*^9}, {
   3.7369310469979916`*^9, 3.7369310630423207`*^9}, {3.736931132420038*^9, 
   3.7369311325293903`*^9}, {3.736932063745055*^9, 3.73693206423477*^9}, {
   3.7450517670806932`*^9, 3.745051793364732*^9}, {3.745053156716096*^9, 
   3.7450531568108854`*^9}, 3.7450531890675974`*^9, {3.7450598852103615`*^9, 
   3.745059885310128*^9}, {3.74506014927607*^9, 3.7450601554347496`*^9}, {
   3.7450602101232204`*^9, 3.7450602103757715`*^9}, 3.74512273679707*^9, {
   3.745135503531702*^9, 3.7451355075474434`*^9}, {3.745141948483966*^9, 
   3.745141981055852*^9}, {3.7451422075704904`*^9, 3.7451422132821407`*^9}, {
   3.745841036856451*^9, 3.7458410551888695`*^9}, {3.74584130684523*^9, 
   3.745841313621033*^9}, {3.7458413618672295`*^9, 3.7458413783575134`*^9}, {
   3.745841552014129*^9, 3.745841563432193*^9}, {3.745841891834644*^9, 
   3.745841897095703*^9}, {3.745918555881321*^9, 3.7459185649346347`*^9}, {
   3.7459192607167788`*^9, 3.7459192649239855`*^9}, {3.7459200291971226`*^9, 
   3.745920030250965*^9}, {3.7459208535222387`*^9, 3.745920856730833*^9}, {
   3.746255694915741*^9, 3.746255700916711*^9}, {3.746255923144405*^9, 
   3.746255959461953*^9}, {3.749209252985916*^9, 3.7492092533364754`*^9}, {
   3.763444411152773*^9, 3.7634444257476797`*^9}, {3.848566330378167*^9, 
   3.8485663405539513`*^9}, {3.848566372284834*^9, 3.848566406265435*^9}, {
   3.8485665390514917`*^9, 3.848566539093354*^9}, {3.848566646275344*^9, 
   3.848566664265484*^9}, {3.855738088385333*^9, 3.8557380911560574`*^9}, {
   3.8557382290133886`*^9, 3.8557382322582645`*^9}, 3.855738356678924*^9, {
   3.855895842545025*^9, 3.855895860981524*^9}, {3.8559040256051273`*^9, 
   3.8559040498692646`*^9}, 3.8559041419037285`*^9, {3.8559041752955036`*^9, 
   3.855904201054645*^9}, {3.8559043492795887`*^9, 3.8559043493264647`*^9}, {
   3.8559048463704567`*^9, 3.8559048469598737`*^9}, {3.8559048859546385`*^9, 
   3.8559048864652405`*^9}, {3.8559055576374006`*^9, 
   3.8559055629472046`*^9}, {3.8559056126613503`*^9, 3.8559056127091856`*^9}, 
   3.8559079769434676`*^9, {3.8559088656230755`*^9, 3.855908865700867*^9}, {
   3.85590976846433*^9, 3.8559097687056847`*^9}, {3.856251906960474*^9, 
   3.8562519160407634`*^9}, {3.856251946909089*^9, 3.8562519469840326`*^9}, 
   3.856258768611953*^9, 3.856258910069477*^9, {3.856259184359799*^9, 
   3.856259184439537*^9}, 3.8562665464765854`*^9, {3.8562842104713583`*^9, 
   3.856284210672991*^9}, {3.866181601055688*^9, 3.8661816156610065`*^9}, {
   3.9012493234985847`*^9, 3.9012493328083963`*^9}, 3.9012517137422504`*^9, 
   3.9012805349273357`*^9, {3.901284849097099*^9, 3.9012848495119295`*^9}, {
   3.901284912680834*^9, 3.901284913176675*^9}, 3.901285048811199*^9, {
   3.901285179881423*^9, 3.9012851813894806`*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"3b06b214-da8b-49f4-8dd6-9127f80c8428"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "layers", " ", "of", " ", "the", " ", 
    "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"VisualizeUNET2D", "[", 
   RowBox[{"testData3", ",", "netTrained3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7367635744536123`*^9, 3.736763586834174*^9}, {
   3.736764000182431*^9, 3.7367640089543753`*^9}, 3.7367643725344725`*^9, {
   3.7367652678051596`*^9, 3.7367652681687517`*^9}, {3.736782988251666*^9, 
   3.7367829947281933`*^9}, {3.7367832730906196`*^9, 3.736783273431922*^9}, {
   3.7369310904001884`*^9, 3.7369311021137085`*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"1426dd22-e2b5-49c7-a999-33fe81b7b170"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "test", " ", "data", " ", "witout", " ", 
    "diff", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData3", ",", " ", "testLabel3", ",", " ", "result3", ",", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "3"}], ",", "\[IndentingNewLine]", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "True"}], ",", 
    RowBox[{"ClassStepSize", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.745142251701399*^9, {3.866181178831828*^9, 3.866181183113557*^9}},
 CellLabel->
  "In[139]:=",ExpressionUUID->"a6d792fe-f1f2-4dfd-84f2-7dab9eca61a5"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Case 4 : 3 channels - 4 classes", "Subsection",
 CellChangeTimes->{{3.736255937786428*^9, 3.736255942050702*^9}, {
   3.7368672510536203`*^9, 3.7368672561377573`*^9}, 3.7368673086760798`*^9, {
   3.7369332111824837`*^9, 
   3.7369332217501698`*^9}},ExpressionUUID->"964043c3-f1f7-4146-9417-\
e090d9b9606d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "test", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data4", ",", "label4"}], "}"}], "=", 
    RowBox[{"MakeTestImages", "[", 
     RowBox[{"100", ",", "4"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736223942920128*^9, 3.736223950732706*^9}, {
  3.7362240856355734`*^9, 3.736224155216504*^9}, {3.736227983792309*^9, 
  3.7362280037391157`*^9}, {3.736411990457652*^9, 3.736411991279434*^9}, {
  3.7364815117213306`*^9, 3.7364815125701046`*^9}, {3.7369312511368146`*^9, 
  3.7369312535016336`*^9}, {3.7369329302140856`*^9, 3.7369329312180758`*^9}},
 CellLabel->
  "In[141]:=",ExpressionUUID->"125b3671-af9a-4048-a4a0-c53abca87d8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"split", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "train4", ",", "valid4", ",", "testData4", ",", "testLabel4", ",", 
      "order4"}], "}"}], "=", 
    RowBox[{"SplitTrainData", "[", 
     RowBox[{"data4", ",", "label4"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736092162506568*^9, 3.7360921717151403`*^9}, {
   3.736093115569694*^9, 3.7360931493970985`*^9}, {3.7360962453078156`*^9, 
   3.7360962816214952`*^9}, {3.736097265636952*^9, 3.7360972662181053`*^9}, {
   3.7361427730684586`*^9, 3.736142786967091*^9}, {3.7361429395526505`*^9, 
   3.7361429399367094`*^9}, {3.7361456385354853`*^9, 3.736145647773047*^9}, {
   3.7361457940966015`*^9, 3.7361458003489246`*^9}, {3.7361479807772937`*^9, 
   3.7361480001513195`*^9}, {3.7361484779289703`*^9, 
   3.7361484874693284`*^9}, {3.736151167964548*^9, 3.736151214340464*^9}, {
   3.736152584980132*^9, 3.736152616490549*^9}, 3.7361529074294634`*^9, 
   3.7361529566400914`*^9, {3.7361531197438593`*^9, 3.73615313179025*^9}, {
   3.7361600789237127`*^9, 3.7361600813580875`*^9}, {3.7361635050115585`*^9, 
   3.736163533463912*^9}, {3.7361644334553747`*^9, 3.7361644338057575`*^9}, {
   3.7362279790764766`*^9, 3.736228032270702*^9}, {3.7362328390168405`*^9, 
   3.7362328408694506`*^9}, {3.736412016557328*^9, 3.736412022914005*^9}, 
   3.7364815312103825`*^9, {3.736481683859022*^9, 3.7364816839823465`*^9}, 
   3.736481815843889*^9, {3.7364825364840155`*^9, 3.7364825453440647`*^9}, {
   3.736482891849559*^9, 3.736482891923483*^9}, {3.736484323508561*^9, 
   3.7364843268249426`*^9}, {3.7364847645303087`*^9, 3.7364847665183306`*^9}, 
   3.7364920191692405`*^9, {3.7364921657699795`*^9, 3.736492165826701*^9}, 
   3.7366673012154317`*^9, {3.73666809453461*^9, 3.7366680946048284`*^9}, 
   3.736782097103197*^9, {3.7367850183587008`*^9, 3.736785025066718*^9}, {
   3.736785061322934*^9, 3.7367850853556614`*^9}, 3.7368517584156976`*^9, {
   3.7368582990044003`*^9, 3.7368583560863895`*^9}, 3.736858526716897*^9, {
   3.7368586492008877`*^9, 3.736858717129797*^9}, {3.7368588001858063`*^9, 
   3.736858866458607*^9}, {3.736858940179243*^9, 3.7368589465502214`*^9}, {
   3.7368589924764147`*^9, 3.736859014101614*^9}, {3.736859046262355*^9, 
   3.736859052569999*^9}, {3.736859351801052*^9, 3.7368593659443073`*^9}, {
   3.7368663005171733`*^9, 3.73686630068001*^9}, 3.736866400802652*^9, {
   3.736866465417356*^9, 3.7368664673121133`*^9}, {3.73686669834263*^9, 
   3.7368667009804106`*^9}, {3.7368668401080923`*^9, 
   3.7368668409069796`*^9}, {3.736866886407938*^9, 3.736866893403507*^9}, {
   3.7368671253434277`*^9, 3.736867125435185*^9}, {3.7368672774770947`*^9, 
   3.7368672851343465`*^9}, {3.736917535059682*^9, 3.736917536516204*^9}, {
   3.7369320881153126`*^9, 3.7369321217600565`*^9}, {3.73693215928226*^9, 
   3.7369321697090592`*^9}, {3.7379939438160057`*^9, 
   3.7379939521298113`*^9}, {3.745920911853548*^9, 3.7459209167496386`*^9}},
 CellLabel->
  "In[142]:=",ExpressionUUID->"6808f64a-a8c2-4d2d-a6c3-8968549d21e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"train", " ", "the", " ", "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"net4", ",", "trained4", ",", "netTrained4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"result4", ",", "iou4"}], "}"}]}], "}"}], "=", 
     RowBox[{"TrainUNET", "[", 
      RowBox[{"train4", ",", "valid4", ",", 
       RowBox[{"{", 
        RowBox[{"testData4", ",", "testLabel4"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BatchSize", "\[Rule]", "32"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TargetDevice", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<GPU\>\"", ",", "1"}], "}"}]}], ",", 
       RowBox[{"MaxTrainingRounds", "\[Rule]", "200"}], ",", 
       RowBox[{"NetParameters", "\[Rule]", "32"}], ",", "\[IndentingNewLine]", 
       RowBox[{"DropoutRate", "\[Rule]", "0.5"}], ",", 
       RowBox[{"AugmentTrainData", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<90\>\"", ",", "False", ",", "True"}], "}"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MakeNetPlots", "[", "trained4", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7369330399724507`*^9, 3.736933040543474*^9}, {
   3.736959177664871*^9, 3.7369591809157424`*^9}, {3.736960635514878*^9, 
   3.7369606376851454`*^9}, {3.7390083464980707`*^9, 
   3.7390083465755215`*^9}, {3.7450522213050623`*^9, 
   3.7450522362267656`*^9}, {3.7450598036412907`*^9, 3.745059803704013*^9}, {
   3.745137913741931*^9, 3.745137953950053*^9}, 3.745141518994564*^9, {
   3.745142272516852*^9, 3.7451422776799207`*^9}, {3.7459203191009035`*^9, 
   3.7459203417378736`*^9}, {3.745920897293714*^9, 3.7459209042823544`*^9}, {
   3.7462564148739552`*^9, 3.746256416628381*^9}, 3.7634726821073194`*^9, {
   3.7634727276366434`*^9, 3.763472745997533*^9}, {3.7634729234631767`*^9, 
   3.763472926088451*^9}, 3.828081318446*^9, {3.8280814489430275`*^9, 
   3.8280814492532334`*^9}, {3.855738929768358*^9, 3.8557389310110364`*^9}, {
   3.855738975767023*^9, 3.8557389978623433`*^9}, {3.8557390409980965`*^9, 
   3.8557390482137766`*^9}, {3.8557392228242264`*^9, 3.8557392228870583`*^9}, 
   3.8557392702297134`*^9, {3.8557394102001705`*^9, 3.8557394248248158`*^9}, 
   3.855909620552457*^9, {3.855909682822728*^9, 3.8559096845367393`*^9}, {
   3.8562539967846136`*^9, 3.856254044784597*^9}, {3.8562578737758226`*^9, 
   3.856257903566175*^9}, {3.856259598568305*^9, 3.856259605557761*^9}, 
   3.8562597832871437`*^9, 3.856259820702011*^9, {3.8562599213678474`*^9, 
   3.856259921427682*^9}, 3.856260382605625*^9, {3.856260450075941*^9, 
   3.8562604540895805`*^9}, {3.8562612378728175`*^9, 3.856261243421248*^9}, 
   3.8562614051678467`*^9, 3.856262177381851*^9, 3.856263660526432*^9, 
   3.856263769976902*^9, 3.8562638700903273`*^9, 3.866026019309062*^9, {
   3.866180879131515*^9, 3.8661808792116385`*^9}, 3.9012805349395556`*^9, {
   3.902550279050524*^9, 
   3.902550279080527*^9}},ExpressionUUID->"1b565e84-1233-49bf-a82f-\
bfd8ecb0e0f5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "layers", " ", "of", " ", "the", " ", 
    "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"VisualizeUNET2D", "[", 
   RowBox[{"testData4", ",", "netTrained4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7367635744536123`*^9, 3.736763586834174*^9}, {
   3.736764000182431*^9, 3.7367640089543753`*^9}, 3.7367643725344725`*^9, {
   3.7367652678051596`*^9, 3.7367652681687517`*^9}, {3.736782988251666*^9, 
   3.7367829947281933`*^9}, {3.7367832730906196`*^9, 3.736783273431922*^9}, {
   3.736932110954464*^9, 3.7369321120053024`*^9}, {3.736932483730036*^9, 
   3.736932484857915*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"c172715b-7ef7-4f63-b6b7-d8ae40ac0b80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "test", " ", "data", " ", "with", " ", 
    "diff", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData4", ",", " ", "testLabel4", ",", 
    RowBox[{"NumberRowItems", "\[Rule]", "2"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.745142251701399*^9, {3.8562544440985126`*^9, 3.856254449106795*^9}, {
   3.85628293152032*^9, 3.8562829315641036`*^9}, 3.856282966956521*^9, {
   3.8660254976082764`*^9, 3.866025520296866*^9}},
 CellLabel->
  "In[145]:=",ExpressionUUID->"cfca2a06-a2b8-4de3-a880-49e794df80b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "validation", " ", "data", " ", "with", " ", 
    "diff", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{
    RowBox[{"valid4", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{";;", "9"}], ",", "1"}], "]"}], "]"}], ",", 
    RowBox[{"valid4", "[", 
     RowBox[{"[", 
      RowBox[{
       RowBox[{";;", "9"}], ",", "2"}], "]"}], "]"}], ",", 
    RowBox[{"ClassDecoder", "[", 
     RowBox[{
      RowBox[{"netTrained4", "[", 
       RowBox[{
        RowBox[{"valid4", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "9"}], ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"TargetDevice", "->", "\"\<GPU\>\""}]}], "]"}], ",", "4"}], 
     "]"}], ",", "\[IndentingNewLine]", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "2"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "True"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.856262147922377*^9, 3.8562621506110735`*^9}, {
   3.856284245143116*^9, 3.856284259366928*^9}, {3.866026264155842*^9, 
   3.866026288877739*^9}, 3.866181085032672*^9, 3.8661811459307966`*^9},
 CellLabel->
  "In[146]:=",ExpressionUUID->"554b0963-b2a6-46a8-9eb9-c6eb91ee7721"]
}, Closed]],

Cell[CellGroupData[{

Cell["Test Case 5 - same as 4 with animation", "Subsection",
 CellChangeTimes->{{3.736255937786428*^9, 3.736255942050702*^9}, {
   3.7368672510536203`*^9, 3.7368672561377573`*^9}, 3.7368673142797565`*^9, {
   3.736932134631217*^9, 3.736932135741583*^9}, {3.736932194610512*^9, 
   3.7369322014387274`*^9}},ExpressionUUID->"55e4d17f-1be9-48ec-9216-\
de51a96b9f9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data5", ",", "label5"}], "}"}], "=", 
   RowBox[{"MakeTestImages", "[", 
    RowBox[{"100", ",", "4"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.736223942920128*^9, 3.736223950732706*^9}, {
  3.7362240856355734`*^9, 3.736224155216504*^9}, {3.736227983792309*^9, 
  3.7362280037391157`*^9}, {3.736411990457652*^9, 3.736411991279434*^9}, {
  3.7364815117213306`*^9, 3.7364815125701046`*^9}, {3.736932202730949*^9, 
  3.736932203782503*^9}, {3.736932992154677*^9, 3.7369329928233414`*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"06fe11a9-6f87-405a-85b5-10db96ad27d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "train5", ",", "valid5", ",", "testData5", ",", "testLabel5", ",", 
     "order"}], "}"}], "=", 
   RowBox[{"SplitTrainData", "[", 
    RowBox[{"data5", ",", "label5"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7369322060703564`*^9, 3.7369322171393476`*^9}, 
   3.7369331349079065`*^9, {3.7457443291486692`*^9, 3.7457443298812675`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"bef28d55-09e5-4665-9030-449498698014"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"choose", " ", "a", " ", "nice", " ", "image"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"MakeChannelImage", "/@", "testData5"}]}]], "Input",
 CellChangeTimes->{{3.73693547211168*^9, 3.736935510323561*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"96777a71-dc2b-4b13-811e-f22204717f57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"im", "=", "6"}], ";", 
  RowBox[{"nchan", "=", 
   RowBox[{"Max", "[", "testLabel5", "]"}]}], ";", 
  RowBox[{"solutions", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"imChan", "=", 
    RowBox[{"First", "@", 
     RowBox[{"MakeChannelImage", "[", 
      RowBox[{"testData5", "[", 
       RowBox[{"[", 
        RowBox[{"im", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"The", " ", "monitoring", " ", "function"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"monitor", "=", 
   RowBox[{
    RowBox[{"AppendTo", "[", 
     RowBox[{"solutions", ",", 
      RowBox[{"ClassDecoder", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"NetExtract", "[", 
          RowBox[{"#Net", ",", "\"\<net\>\""}], "]"}], "[", 
         RowBox[{
          RowBox[{"testData5", "[", 
           RowBox[{"[", "im", "]"}], "]"}], ",", 
          RowBox[{"TargetDevice", "\[Rule]", "\"\<GPU\>\""}]}], "]"}], ",", 
        "nchan"}], "]"}]}], "]"}], "&"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.8559130649212046`*^9, 3.855913064982029*^9}, {
  3.8562671157355595`*^9, 3.856267117031043*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"4a0b0ccf-5dc7-4bff-b9dc-a6c24d80b0eb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "train", " ", "the", " ", "net", " ", "with", " ", "monitor", " ", 
    "function"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"net", ",", "trained", ",", "netTrained"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"result", ",", "iou"}], "}"}]}], "}"}], "=", 
     RowBox[{"TrainUNET", "[", 
      RowBox[{"train5", ",", "valid5", ",", 
       RowBox[{"{", 
        RowBox[{"testData5", ",", "testLabel5"}], "}"}], ",", 
       RowBox[{"BatchSize", "\[Rule]", "35"}], ",", "\[IndentingNewLine]", 
       " ", 
       RowBox[{"TargetDevice", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<GPU\>\"", ",", "1"}], "}"}]}], ",", 
       RowBox[{"MaxTrainingRounds", "\[Rule]", "200"}], ",", 
       RowBox[{"NetParameters", "\[Rule]", "16"}], ",", 
       RowBox[{"DropoutRate", "\[Rule]", ".5"}], ",", 
       RowBox[{"NetLossLayers", "\[Rule]", "All"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AugmentTrainData", "->", 
        RowBox[{"{", 
         RowBox[{"\"\<90\>\"", ",", "False", ",", "True"}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TrainingProgressFunction", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"monitor", ",", 
          RowBox[{"\"\<Interval\>\"", "\[Rule]", 
           RowBox[{"Quantity", "[", 
            RowBox[{"1", ",", "\"\<Rounds\>\""}], "]"}]}]}], "}"}]}]}], 
      "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"MakeNetPlots", "[", "trained", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.736092162506568*^9, 3.7360921717151403`*^9}, {
   3.736093115569694*^9, 3.7360931493970985`*^9}, {3.7360962453078156`*^9, 
   3.7360962816214952`*^9}, {3.736097265636952*^9, 3.7360972662181053`*^9}, {
   3.7361427730684586`*^9, 3.736142786967091*^9}, {3.7361429395526505`*^9, 
   3.7361429399367094`*^9}, {3.7361456385354853`*^9, 3.736145647773047*^9}, {
   3.7361457940966015`*^9, 3.7361458003489246`*^9}, {3.7361479807772937`*^9, 
   3.7361480001513195`*^9}, {3.7361484779289703`*^9, 
   3.7361484874693284`*^9}, {3.736151167964548*^9, 3.736151214340464*^9}, {
   3.736152584980132*^9, 3.736152616490549*^9}, 3.7361529074294634`*^9, 
   3.7361529566400914`*^9, {3.7361531197438593`*^9, 3.73615313179025*^9}, {
   3.7361600789237127`*^9, 3.7361600813580875`*^9}, {3.7361635050115585`*^9, 
   3.736163533463912*^9}, {3.7361644334553747`*^9, 3.7361644338057575`*^9}, {
   3.7362279790764766`*^9, 3.736228032270702*^9}, {3.7362328390168405`*^9, 
   3.7362328408694506`*^9}, {3.736412016557328*^9, 3.736412022914005*^9}, 
   3.7364815312103825`*^9, {3.736481683859022*^9, 3.7364816839823465`*^9}, 
   3.736481815843889*^9, {3.7364825364840155`*^9, 3.7364825453440647`*^9}, {
   3.736482891849559*^9, 3.736482891923483*^9}, {3.736484323508561*^9, 
   3.7364843268249426`*^9}, {3.7364847645303087`*^9, 3.7364847665183306`*^9}, 
   3.7364920191692405`*^9, {3.7364921657699795`*^9, 3.736492165826701*^9}, 
   3.7366673012154317`*^9, {3.73666809453461*^9, 3.7366680946048284`*^9}, 
   3.736782097103197*^9, {3.7367850183587008`*^9, 3.736785025066718*^9}, {
   3.736785061322934*^9, 3.7367850853556614`*^9}, 3.7368517584156976`*^9, {
   3.7368582990044003`*^9, 3.7368583560863895`*^9}, 3.736858526716897*^9, {
   3.7368586492008877`*^9, 3.736858717129797*^9}, {3.7368588001858063`*^9, 
   3.736858866458607*^9}, {3.736858940179243*^9, 3.7368589465502214`*^9}, {
   3.7368589924764147`*^9, 3.736859014101614*^9}, {3.736859046262355*^9, 
   3.736859052569999*^9}, {3.736859351801052*^9, 3.7368593659443073`*^9}, {
   3.7368663005171733`*^9, 3.73686630068001*^9}, 3.736866400802652*^9, {
   3.736866465417356*^9, 3.7368664673121133`*^9}, {3.73686669834263*^9, 
   3.7368667009804106`*^9}, {3.7368668401080923`*^9, 
   3.7368668409069796`*^9}, {3.736866886407938*^9, 3.736866893403507*^9}, {
   3.7368671253434277`*^9, 3.736867125435185*^9}, 3.7368798261569777`*^9, 
   3.7368799303308864`*^9, {3.7368803799081187`*^9, 3.7368803800487766`*^9}, {
   3.7369176122008257`*^9, 3.73691761866465*^9}, {3.7369321806366863`*^9, 
   3.736932184340496*^9}, {3.736932221681879*^9, 3.7369322590535564`*^9}, {
   3.7369331433651047`*^9, 3.7369331553683662`*^9}, {3.736934283934451*^9, 
   3.7369342923877416`*^9}, 3.736934332795584*^9, {3.7369345153409557`*^9, 
   3.736934527555962*^9}, 3.7369352486234846`*^9, 3.7369354618722663`*^9, 
   3.736935518634939*^9, {3.745061413580042*^9, 3.7450614499150825`*^9}, {
   3.7450615015909233`*^9, 3.745061504956669*^9}, {3.745744347322223*^9, 
   3.745744404794508*^9}, {3.7459217722930684`*^9, 3.7459218313735*^9}, 
   3.746256730439884*^9, 3.8522845158430567`*^9, {3.852287466903853*^9, 
   3.852287483201545*^9}, {3.852287537198345*^9, 3.8522875726749887`*^9}, 
   3.85228778958991*^9, {3.852287846915612*^9, 3.852287846999613*^9}, {
   3.855739750425193*^9, 3.855739754616499*^9}, {3.8557398130655756`*^9, 
   3.8557398131124516`*^9}, 3.855740318461348*^9, {3.8557403950100574`*^9, 
   3.8557404072609005`*^9}, {3.855740451918882*^9, 3.855740453118696*^9}, {
   3.855740532495534*^9, 3.8557405330230846`*^9}, 3.8557405949581757`*^9, {
   3.8557413169334135`*^9, 3.8557413175687294`*^9}, {3.855741785891779*^9, 
   3.855741785971557*^9}, {3.8557419009178143`*^9, 3.8557419009657097`*^9}, {
   3.8557419581642485`*^9, 3.855741958217079*^9}, 3.855742346661662*^9, {
   3.855742390438525*^9, 3.855742390530282*^9}, {3.855912190898963*^9, 
   3.855912229681409*^9}, {3.855912469031644*^9, 3.85591247116875*^9}, {
   3.855912729064973*^9, 3.8559127358124247`*^9}, {3.8562670632358027`*^9, 
   3.8562670635475626`*^9}, {3.8562830752676573`*^9, 
   3.8562830990891957`*^9}, {3.8562842877031903`*^9, 3.8562842908918066`*^9}, 
   3.866181192979292*^9, {3.8661825674620857`*^9, 3.8661825675084887`*^9}, 
   3.901280534952794*^9},ExpressionUUID->"b7fa51b1-f13a-4548-a211-\
50b5ce13ed63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "test", " ", "data", " ", "witout", " ", 
    "diff", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData5", ",", " ", "testLabel5", ",", " ", "result", ",", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "2"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "True"}], ",", 
    RowBox[{"ClassStepSize", "\[Rule]", "1"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "650"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.736932982185239*^9, {3.7369330334249287`*^9, 3.736933036896783*^9}, 
   3.7369331112241325`*^9, {3.7369604850878963`*^9, 3.7369604855128164`*^9}, {
   3.736960532631493*^9, 3.7369605448294716`*^9}, {3.855741227791608*^9, 
   3.8557412349438367`*^9}, {3.866182475426688*^9, 3.8661824762259164`*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"05a332b7-cd85-4aa1-a141-9cbca6c4e693"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "the", " ", "animation", " ", "images"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"solIm", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ColorReplace", "[", 
        RowBox[{
         RowBox[{"MakeClassImage", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "0", 
          "]"}]}], "]"}], "&"}], "/@", "solutions"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"anim", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ImageCompose", "[", 
          RowBox[{"imChan", ",", 
           RowBox[{"{", 
            RowBox[{"sol", ",", ".5"}], "}"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"sol", ",", "solIm"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"play", " ", "the", " ", "animatin"}], "*)"}], "\n", 
   RowBox[{"Animate", "[", 
    RowBox[{"im", ",", 
     RowBox[{"{", 
      RowBox[{"im", ",", "anim"}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8557398521566133`*^9, 3.855739854558196*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"0c83e808-9b15-4870-a4a9-6bb22404d2fa"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<anim-v2.gif\>\"", ",", "anim", ",", 
   RowBox[{"\"\<DisplayDuration\>\"", "\[Rule]", ".2"}], ",", 
   RowBox[{"\"\<AnimationRepetitions\>\"", "\[Rule]", "Infinity"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.745061655136744*^9, 3.745061663453594*^9}, {
  3.7450617026360784`*^9, 3.745061787290922*^9}, {3.74506190779112*^9, 
  3.745061909851161*^9}, {3.8559137971973777`*^9, 3.8559137998712187`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"7bf644ba-e208-4ac9-aaa9-433cfb0043e2"]
}, Closed]]
}, Open  ]]
},
WindowSize->{888, 1395.75},
WindowMargins->{{Automatic, -900}, {Automatic, -203.25}},
FrontEndVersion->"13.3 for Microsoft Windows (64-bit) (June 3, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c47e877a-cca4-4447-b282-a8edfb62ddb3"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 381, 7, 21, "Input",ExpressionUUID->"80736651-f97a-4200-a95d-e5276942b499"],
Cell[CellGroupData[{
Cell[964, 31, 212, 4, 50, "Section",ExpressionUUID->"ebfce3f0-781e-489b-a324-413b4e2a0e96"],
Cell[CellGroupData[{
Cell[1201, 39, 259, 4, 41, "Subsection",ExpressionUUID->"efe280f3-51c2-47b4-bc78-b0dd9eb22424"],
Cell[1463, 45, 559, 13, 64, "Input",ExpressionUUID->"c50cec09-b001-43dc-bce8-060fc1ebe1c5"],
Cell[2025, 60, 854, 12, 21, "Input",ExpressionUUID->"f945d82f-8def-4ae4-8544-3ae92921c382"],
Cell[2882, 74, 625, 10, 21, "Input",ExpressionUUID->"71998f84-3622-409a-8e60-749763d086f5"],
Cell[3510, 86, 611, 10, 21, "Input",ExpressionUUID->"9e7ddaa3-307e-4dd2-ae62-b79aeaefa225"],
Cell[4124, 98, 839, 12, 21, "Input",ExpressionUUID->"4b5f34bf-287a-4137-9f05-93f897bfd421"],
Cell[4966, 112, 935, 13, 21, "Input",ExpressionUUID->"2dc3f972-5ec6-4802-9dad-d19e96ab1bdf"]
}, Closed]],
Cell[CellGroupData[{
Cell[5938, 130, 261, 4, 30, "Subsection",ExpressionUUID->"c2c1a71e-7be2-429c-b2b4-d117e403cf3c"],
Cell[6202, 136, 601, 15, 64, "Input",ExpressionUUID->"6d339c2b-2d9d-44dd-9e0a-4a0dbeecbfc6"],
Cell[6806, 153, 823, 12, 21, "Input",ExpressionUUID->"2e5674ad-0fe3-4174-a86f-90995360b162"],
Cell[7632, 167, 580, 9, 21, "Input",ExpressionUUID->"5e4eecce-caf9-4cb0-b292-96f4955fe501"],
Cell[8215, 178, 551, 9, 21, "Input",ExpressionUUID->"33f4c15b-7088-4cb8-9e81-d426ff056818"],
Cell[8769, 189, 807, 12, 21, "Input",ExpressionUUID->"b10a0e6b-4f32-40ae-8896-6f45a3790cde"],
Cell[9579, 203, 835, 12, 21, "Input",ExpressionUUID->"ae4bf7b0-fe1c-439e-8188-624c257a1963"]
}, Closed]],
Cell[CellGroupData[{
Cell[10451, 220, 214, 4, 30, "Subsection",ExpressionUUID->"76f5f44a-4849-492f-91b6-2840ffd5e759"],
Cell[10668, 226, 3129, 80, 193, "Input",ExpressionUUID->"7f5059a8-2613-4aa5-a092-89b68762a5b0"],
Cell[13800, 308, 4568, 90, 136, "Input",ExpressionUUID->"b761a02b-0a72-4ab9-963b-f19b4aeedd21"],
Cell[18371, 400, 3901, 81, 136, "Input",ExpressionUUID->"aed1bab8-edac-4d92-9541-4eccb772481b"],
Cell[22275, 483, 3172, 82, 136, "Input",ExpressionUUID->"13c62ff2-efd8-49ab-9e9d-4cee405fe2c5"],
Cell[25450, 567, 3044, 79, 136, "Input",ExpressionUUID->"4cb80908-6117-4edc-a469-e3c9fc57b616"]
}, Closed]],
Cell[CellGroupData[{
Cell[28531, 651, 222, 4, 30, "Subsection",ExpressionUUID->"82f847f8-af86-4335-b010-0b525865d7eb"],
Cell[28756, 657, 603, 15, 36, "Input",ExpressionUUID->"836a86c0-c7ac-4ccb-bfdc-9ed48356a9a9"],
Cell[29362, 674, 657, 15, 36, "Input",ExpressionUUID->"68d492e8-df7c-44dd-bd79-7202d31beee2"],
Cell[30022, 691, 690, 18, 36, "Input",ExpressionUUID->"f0cb3ed1-b97f-4cd2-8a80-5c47ebc56121"],
Cell[30715, 711, 668, 17, 36, "Input",ExpressionUUID->"970c22ac-cfcc-428b-a387-451a782d95b5"]
}, Closed]],
Cell[CellGroupData[{
Cell[31420, 733, 313, 5, 30, "Subsection",ExpressionUUID->"f0a4d34d-373a-4eff-a8eb-07e59aabf187"],
Cell[31736, 740, 658, 15, 36, "Input",ExpressionUUID->"5f25cc7b-42de-4d1f-a5d8-82a79441e73b"],
Cell[32397, 757, 3175, 50, 36, "Input",ExpressionUUID->"a8cd47fa-548c-447b-ad56-a6db4a07fd36"],
Cell[35575, 809, 2978, 55, 64, "Input",ExpressionUUID->"e628eb92-cfc7-44bc-8c58-0ac81605d1ae"],
Cell[38556, 866, 754, 15, 36, "Input",ExpressionUUID->"18a352a1-5023-43ff-8324-5c2f5303f12b"],
Cell[39313, 883, 793, 16, 36, "Input",ExpressionUUID->"b0544004-dc84-4858-852b-930cdc49ac1d"],
Cell[40109, 901, 788, 15, 36, "Input",ExpressionUUID->"d42a3795-8587-44e7-897d-9edcd48c49eb"]
}, Closed]],
Cell[CellGroupData[{
Cell[40934, 921, 261, 4, 30, "Subsection",ExpressionUUID->"ae8a8131-f090-4256-99d8-202947e3efc1"],
Cell[41198, 927, 681, 15, 36, "Input",ExpressionUUID->"b5a917a9-f063-4532-b914-d9977b90bb50"],
Cell[41882, 944, 633, 16, 36, "Input",ExpressionUUID->"7d59c487-cc4e-4c58-95d2-35721084a132"],
Cell[42518, 962, 2727, 50, 79, "Input",ExpressionUUID->"e011104e-23ba-49d9-89cd-0622d4202e2e"],
Cell[45248, 1014, 750, 14, 36, "Input",ExpressionUUID->"eba55e35-2f18-4a6f-9d99-93a7d09cf581"],
Cell[46001, 1030, 1067, 19, 36, "Input",ExpressionUUID->"25af0373-c2c0-46f7-bf72-f026e1a97ed9"]
}, Closed]],
Cell[CellGroupData[{
Cell[47105, 1054, 287, 4, 30, "Subsection",ExpressionUUID->"07eca103-b55f-49fe-a389-80f1a5adc8a6"],
Cell[47395, 1060, 1608, 28, 36, "Input",ExpressionUUID->"559b218e-8545-4e88-8a6a-59431ce4a153"],
Cell[49006, 1090, 1133, 22, 36, "Input",ExpressionUUID->"60d35187-9ae0-44fc-bb7e-d20386da86c6"],
Cell[50142, 1114, 4082, 68, 79, "Input",ExpressionUUID->"3b06b214-da8b-49f4-8dd6-9127f80c8428"],
Cell[54227, 1184, 704, 14, 36, "Input",ExpressionUUID->"1426dd22-e2b5-49c7-a999-33fe81b7b170"],
Cell[54934, 1200, 688, 14, 50, "Input",ExpressionUUID->"a6d792fe-f1f2-4dfd-84f2-7dab9eca61a5"]
}, Closed]],
Cell[CellGroupData[{
Cell[55659, 1219, 317, 5, 30, "Subsection",ExpressionUUID->"964043c3-f1f7-4146-9417-e090d9b9606d"],
Cell[55979, 1226, 761, 16, 36, "Input",ExpressionUUID->"125b3671-af9a-4048-a4a0-c53abca87d8a"],
Cell[56743, 1244, 3123, 49, 36, "Input",ExpressionUUID->"6808f64a-a8c2-4d2d-a6c3-8968549d21e1"],
Cell[59869, 1295, 3075, 56, 93, "Input",ExpressionUUID->"1b565e84-1233-49bf-a82f-bfd8ecb0e0f5"],
Cell[62947, 1353, 748, 14, 36, "Input",ExpressionUUID->"c172715b-7ef7-4f63-b6b7-d8ae40ac0b80"],
Cell[63698, 1369, 711, 15, 36, "Input",ExpressionUUID->"cfca2a06-a2b8-4de3-a880-49e794df80b0"],
Cell[64412, 1386, 1280, 32, 50, "Input",ExpressionUUID->"554b0963-b2a6-46a8-9eb9-c6eb91ee7721"]
}, Closed]],
Cell[CellGroupData[{
Cell[65729, 1423, 363, 5, 30, "Subsection",ExpressionUUID->"55e4d17f-1be9-48ec-9216-de51a96b9f9e"],
Cell[66095, 1430, 636, 12, 21, "Input",ExpressionUUID->"06fe11a9-6f87-405a-85b5-10db96ad27d6"],
Cell[66734, 1444, 490, 11, 21, "Input",ExpressionUUID->"bef28d55-09e5-4665-9030-449498698014"],
Cell[67227, 1457, 341, 7, 36, "Input",ExpressionUUID->"96777a71-dc2b-4b13-811e-f22204717f57"],
Cell[67571, 1466, 1341, 37, 64, "Input",ExpressionUUID->"4a0b0ccf-5dc7-4bff-b9dc-a6c24d80b0eb"],
Cell[68915, 1505, 5926, 99, 93, "Input",ExpressionUUID->"b7fa51b1-f13a-4548-a211-50b5ce13ed63"],
Cell[74844, 1606, 943, 17, 36, "Input",ExpressionUUID->"05a332b7-cd85-4aa1-a141-9cbca6c4e693"],
Cell[75790, 1625, 1448, 41, 93, "Input",ExpressionUUID->"0c83e808-9b15-4870-a4a9-6bb22404d2fa"],
Cell[77241, 1668, 537, 9, 21, "Input",ExpressionUUID->"7bf644ba-e208-4ac9-aaa9-433cfb0043e2"]
}, Closed]]
}, Open  ]]
}
]
*)

