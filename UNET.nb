(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     91211,       2017]
NotebookOptionsPosition[     81493,       1880]
NotebookOutlinePosition[     81901,       1896]
CellTagsIndexPosition[     81858,       1893]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"UNET`$Verbose", "=", "True"}]], "Input",
 CellChangeTimes->{{3.850195738003997*^9, 3.8501957402197495`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"80736651-f97a-4200-a95d-e5276942b499"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.8501957411528463`*^9},
 CellLabel->"Out[12]=",ExpressionUUID->"636d88f2-cf27-4d98-8754-b56a1417256b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "UNET`"}]], "Input",
 CellChangeTimes->{{3.7367782195967054`*^9, 3.7367782212429743`*^9}, {
  3.7367801984031935`*^9, 3.736780198533888*^9}},
 CellLabel->"In[13]:=",ExpressionUUID->"6cde7411-8cca-411f-86d1-0325e4d2643a"],

Cell[CellGroupData[{

Cell[BoxData["\<\"--------------------------------------\"\>"], "Print",
 CellChangeTimes->{3.850195742714712*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"5170b966-c667-4dc2-b637-50709e10d45c"],

Cell[BoxData["\<\"All defined packages to be loaded are: \"\>"], "Print",
 CellChangeTimes->{3.8501957427216935`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"fe21444d-b6c1-4cee-be7d-d8d0a29bc051"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"UNET`UnetCore`\"\>", ",", "\<\"UNET`UnetSupport`\"\>"}], 
  "}"}]], "Print",
 CellChangeTimes->{3.850195742753981*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"b50d93d5-987b-4cec-922d-0a2f6b67f314"],

Cell[BoxData["\<\"--------------------------------------\"\>"], "Print",
 CellChangeTimes->{3.8501957427599583`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"eebcbe40-b7f2-4310-a2db-39be66ba9edc"],

Cell[BoxData["\<\"Removing all definitions of UNET`UnetCore`\"\>"], "Print",
 CellChangeTimes->{3.850195742848752*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"da54ca5e-2463-4e22-8ab3-5f324dc907be"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- Package functions: \\n\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"\<\"AddLossLayer\"\>", ",", "\<\"AugmentTrainData\"\>", 
     ",", "\<\"BlockType\"\>", ",", "\<\"BrierLossLayer\"\>", 
     ",", "\<\"ClassDecoder\"\>", ",", "\<\"ClassEncoder\"\>", 
     ",", "\<\"ClassScale\"\>", ",", "\<\"DiceSimilarity\"\>", 
     ",", "\<\"DiceSimilarityClass\"\>", ",", "\<\"DropOutRate\"\>", 
     ",", "\<\"MakeChannelImage\"\>", ",", "\<\"MakeClassImage\"\>", 
     ",", "\<\"MakeDifferenceImage\"\>", ",", "\<\"MakeDiffLabel\"\>", 
     ",", "\<\"MakeNetPlots\"\>", ",", "\<\"MakeUNET\"\>", 
     ",", "\<\"NetLossLayers\"\>", ",", "\<\"NetParameters\"\>", 
     ",", "\<\"NumberRowItems\"\>", ",", "\<\"RandomizeSplit\"\>", 
     ",", "\<\"RotateFlip\"\>", ",", "\<\"ShowChannelClassData\"\>", 
     ",", "\<\"SoftDiceLossLayer\"\>", ",", "\<\"SplitRatios\"\>", 
     ",", "\<\"SplitTrainData\"\>", ",", "\<\"StepSize\"\>", 
     ",", "\<\"TrainUNET\"\>", ",", "\<\"VisualizeUNET2D\"\>"}], "}"}]}],
  SequenceForm[
  "- Package functions: \n", {
   "AddLossLayer", "AugmentTrainData", "BlockType", "BrierLossLayer", 
    "ClassDecoder", "ClassEncoder", "ClassScale", "DiceSimilarity", 
    "DiceSimilarityClass", "DropOutRate", "MakeChannelImage", 
    "MakeClassImage", "MakeDifferenceImage", "MakeDiffLabel", "MakeNetPlots", 
    "MakeUNET", "NetLossLayers", "NetParameters", "NumberRowItems", 
    "RandomizeSplit", "RotateFlip", "ShowChannelClassData", 
    "SoftDiceLossLayer", "SplitRatios", "SplitTrainData", "StepSize", 
    "TrainUNET", "VisualizeUNET2D"}],
  Editable->False]], "Print",
 CellChangeTimes->{3.850195742920878*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"adab6510-09df-44a7-9de5-bcd195113ab8"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- Package functions in global:\\n\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "}"}]}],
  SequenceForm["- Package functions in global:\n", {}],
  Editable->False]], "Print",
 CellChangeTimes->{3.8501957429320803`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"cf9c9ce8-7e3d-4964-8d37-93a2a59d8c9b"],

Cell[BoxData["\<\"Removing all definitions of UNET`UnetSupport`\"\>"], "Print",
 CellChangeTimes->{3.850195743081899*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"da9828d8-ad7a-416a-b9d1-36d9eea0125f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- Package functions: \\n\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"\<\"CreateImage1\"\>", ",", "\<\"CreateImage2\"\>", 
     ",", "\<\"CreateImage3\"\>", ",", "\<\"CreateImage4\"\>", 
     ",", "\<\"MakeTestImages\"\>"}], "}"}]}],
  SequenceForm[
  "- Package functions: \n", {
   "CreateImage1", "CreateImage2", "CreateImage3", "CreateImage4", 
    "MakeTestImages"}],
  Editable->False]], "Print",
 CellChangeTimes->{3.8501957431508713`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"7f7d7aa4-5f1c-4bfb-b43f-13230872b32f"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"- Package functions in global:\\n\"\>", "\[InvisibleSpace]", 
   RowBox[{"{", "}"}]}],
  SequenceForm["- Package functions in global:\n", {}],
  Editable->False]], "Print",
 CellChangeTimes->{3.8501957431558385`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"9ad66a3b-ae92-46ff-bab4-6a64ac6c3c87"],

Cell[BoxData["\<\"--------------------------------------\"\>"], "Print",
 CellChangeTimes->{3.8501957433058014`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"135da847-1ade-46e4-8413-4fab28de5783"],

Cell[BoxData["\<\"Loading all definitions of UNET`UnetCore`\"\>"], "Print",
 CellChangeTimes->{3.850195743309659*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"de2da9f6-3528-45ea-8d90-c41c9dea92c6"],

Cell[BoxData["\<\"Loading all definitions of UNET`UnetSupport`\"\>"], "Print",
 CellChangeTimes->{3.8501957433146467`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"575f737e-2284-4bfb-9abe-86492d7c65de"],

Cell[BoxData["\<\"--------------------------------------\"\>"], "Print",
 CellChangeTimes->{3.850195743318699*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"851a0a48-bde5-4f34-a8a0-df7338b5fff0"],

Cell[BoxData["\<\"protecting all definitions of UNET`UnetCore`\"\>"], "Print",
 CellChangeTimes->{3.850195743322669*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"6c92f8a9-771d-4280-9022-67e408cd4729"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"AddLossLayer\"\>", ",", "\<\"AugmentTrainData\"\>", 
   ",", "\<\"BlockType\"\>", ",", "\<\"BrierLossLayer\"\>", 
   ",", "\<\"ClassDecoder\"\>", ",", "\<\"ClassEncoder\"\>", 
   ",", "\<\"ClassScale\"\>", ",", "\<\"DiceSimilarity\"\>", 
   ",", "\<\"DiceSimilarityClass\"\>", ",", "\<\"DropOutRate\"\>", 
   ",", "\<\"MakeChannelImage\"\>", ",", "\<\"MakeClassImage\"\>", 
   ",", "\<\"MakeDifferenceImage\"\>", ",", "\<\"MakeDiffLabel\"\>", 
   ",", "\<\"MakeNetPlots\"\>", ",", "\<\"MakeUNET\"\>", 
   ",", "\<\"NetLossLayers\"\>", ",", "\<\"NetParameters\"\>", 
   ",", "\<\"NumberRowItems\"\>", ",", "\<\"RandomizeSplit\"\>", 
   ",", "\<\"RotateFlip\"\>", ",", "\<\"ShowChannelClassData\"\>", 
   ",", "\<\"SoftDiceLossLayer\"\>", ",", "\<\"SplitRatios\"\>", 
   ",", "\<\"SplitTrainData\"\>", ",", "\<\"StepSize\"\>", 
   ",", "\<\"TrainUNET\"\>", ",", "\<\"VisualizeUNET2D\"\>"}], "}"}]], "Print",
 CellChangeTimes->{3.8501957433925953`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"a4d1dd0d-05e2-41bb-9e49-f5ffd308ebbc"],

Cell[BoxData["\<\"--------------------------------------\"\>"], "Print",
 CellChangeTimes->{3.8501957433975277`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"a7359c79-6665-4f39-924f-4a3a9df3ca96"],

Cell[BoxData["\<\"protecting all definitions of UNET`UnetSupport`\"\>"], \
"Print",
 CellChangeTimes->{3.850195743400519*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"b9008b45-5df8-40eb-8180-6c42948a0990"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"CreateImage1\"\>", ",", "\<\"CreateImage2\"\>", 
   ",", "\<\"CreateImage3\"\>", ",", "\<\"CreateImage4\"\>", 
   ",", "\<\"MakeTestImages\"\>"}], "}"}]], "Print",
 CellChangeTimes->{3.8501957434051466`*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"590e1faa-6c2d-40c5-a12a-7da695e95a73"],

Cell[BoxData["\<\"--------------------------------------\"\>"], "Print",
 CellChangeTimes->{3.850195743410063*^9},
 CellLabel->
  "During evaluation of \
In[13]:=",ExpressionUUID->"bfa6a001-281e-4cef-bc4b-6b2b90fbed88"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generated Data", "Section",
 CellChangeTimes->{{3.736158374831335*^9, 3.7361583784555874`*^9}, 
   3.7362558940026937`*^9, 
   3.736821898130583*^9},ExpressionUUID->"ebfce3f0-781e-489b-a324-\
413b4e2a0e96"],

Cell[CellGroupData[{

Cell["Show 2D UNET", "Subsection",
 CellChangeTimes->{{3.745075168901682*^9, 3.7450751811326494`*^9}, {
  3.750392396919392*^9, 3.7503923970805225`*^9}, {3.848564489585317*^9, 
  3.848564492492653*^9}},ExpressionUUID->"efe280f3-51c2-47b4-bc78-\
b0dd9eb22424"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dim", "=", 
   RowBox[{"{", 
    RowBox[{"112", ",", "112"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749959904969222*^9, 3.749959913431817*^9}, 
   3.8396568904512916`*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"c50cec09-b001-43dc-bce8-060fc1ebe1c5"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"1", ",", "8", ",", "32", ",", "dim", ",", 
   RowBox[{"DropOutRate", "\[Rule]", ".5"}], ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UNET\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.745216488810031*^9, 3.7452165193851957`*^9}, {
   3.7459192848425136`*^9, 3.7459193016397495`*^9}, {3.746252116097231*^9, 
   3.746252123166115*^9}, 3.748869990911284*^9, {3.749959918028756*^9, 
   3.7499599182994757`*^9}, {3.752236566015766*^9, 3.7522365665872755`*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"f945d82f-8def-4ae4-8544-3ae92921c382"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"1", ",", "8", ",", "32", ",", "dim", ",", 
   RowBox[{"DropOutRate", "\[Rule]", ".5"}], ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UResNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7462521338213315`*^9, {3.7488699945277333`*^9, 3.7488699946229763`*^9}, 
   3.749873564378894*^9, {3.7499599274995117`*^9, 3.7499599278075113`*^9}, 
   3.7522365706070485`*^9},
 CellLabel->"In[11]:=",ExpressionUUID->"71998f84-3622-409a-8e60-749763d086f5"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"1", ",", "8", ",", "32", ",", "dim", ",", 
   RowBox[{"DropOutRate", "\[Rule]", ".5"}], ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<ResNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7462521338213315`*^9, {3.7488699945277333`*^9, 3.7488699946229763`*^9}, {
   3.749959932431128*^9, 3.7499599327791405`*^9}, 3.752236571277831*^9},
 CellLabel->"In[12]:=",ExpressionUUID->"9e7ddaa3-307e-4dd2-ae62-b79aeaefa225"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"1", ",", "8", ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", "dim", ",", 
   RowBox[{"DropOutRate", "\[Rule]", ".5"}], ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UDenseNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7462521277782135`*^9, 3.746252137151247*^9}, 
   3.7488686441228127`*^9, {3.7488699979347563`*^9, 3.7488699980450597`*^9}, {
   3.749873446537406*^9, 3.7498734478017707`*^9}, 3.7498746705329823`*^9, 
   3.7498747783759313`*^9, {3.749959938506793*^9, 3.7499599391067953`*^9}, 
   3.7522365719345875`*^9},
 CellLabel->"In[13]:=",ExpressionUUID->"4b5f34bf-287a-4137-9f05-93f897bfd421"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"1", ",", "8", ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"128", ",", "128"}], "}"}], ",", 
   RowBox[{"DropOutRate", "\[Rule]", ".5"}], ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<DenseNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7462521277782135`*^9, 3.746252137151247*^9}, 
   3.7488686441228127`*^9, {3.7488699979347563`*^9, 3.7488699980450597`*^9}, {
   3.749873446537406*^9, 3.7498734478017707`*^9}, 3.752236572580288*^9, {
   3.8388693729584975`*^9, 3.8388693735818653`*^9}, 3.8396568199240036`*^9},
 CellLabel->"In[14]:=",ExpressionUUID->"2dc3f972-5ec6-4802-9dad-d19e96ab1bdf"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Show 3D UNET", "Subsection",
 CellChangeTimes->{{3.745075168901682*^9, 3.7450751811326494`*^9}, {
  3.750392396919392*^9, 3.7503923970805225`*^9}, {3.8485644975504436`*^9, 
  3.848564499149523*^9}},ExpressionUUID->"c2c1a71e-7be2-429c-b2b4-\
d117e403cf3c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"dim", "=", 
   RowBox[{"{", 
    RowBox[{"32", ",", "112", ",", "112"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.749959904969222*^9, 3.749959913431817*^9}},
 CellLabel->"In[15]:=",ExpressionUUID->"6d339c2b-2d9d-44dd-9e0a-4a0dbeecbfc6"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"1", ",", "8", ",", "32", ",", "dim", ",", 
   RowBox[{"DropOutRate", "\[Rule]", ".5"}], ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UNET\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.745216488810031*^9, 3.7452165193851957`*^9}, {
   3.7459192848425136`*^9, 3.7459193016397495`*^9}, {3.746252116097231*^9, 
   3.746252123166115*^9}, 3.748869990911284*^9, {3.749959918028756*^9, 
   3.7499599182994757`*^9}, {3.752236566015766*^9, 3.7522365665872755`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"2e5674ad-0fe3-4174-a86f-90995360b162"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"1", ",", "8", ",", "32", ",", "dim", ",", 
   RowBox[{"DropOutRate", "\[Rule]", ".5"}], ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UResNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7462521338213315`*^9, {3.7488699945277333`*^9, 3.7488699946229763`*^9}, 
   3.749873564378894*^9, {3.7499599274995117`*^9, 3.7499599278075113`*^9}, 
   3.7522365706070485`*^9},
 CellLabel->"In[17]:=",ExpressionUUID->"5e4eecce-caf9-4cb0-b292-96f4955fe501"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"1", ",", "8", ",", "32", ",", "dim", ",", 
   RowBox[{"DropOutRate", "\[Rule]", ".5"}], ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<ResNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.7462521338213315`*^9, {3.7488699945277333`*^9, 3.7488699946229763`*^9}, {
   3.749959932431128*^9, 3.7499599327791405`*^9}, 3.752236571277831*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"33f4c15b-7088-4cb8-9e81-d426ff056818"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"1", ",", "8", ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", "dim", ",", 
   RowBox[{"DropOutRate", "\[Rule]", ".5"}], ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<UDenseNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7462521277782135`*^9, 3.746252137151247*^9}, 
   3.7488686441228127`*^9, {3.7488699979347563`*^9, 3.7488699980450597`*^9}, {
   3.749873446537406*^9, 3.7498734478017707`*^9}, 3.7498746705329823`*^9, 
   3.7498747783759313`*^9, {3.749959938506793*^9, 3.7499599391067953`*^9}, 
   3.7522365719345875`*^9},
 CellLabel->"In[19]:=",ExpressionUUID->"b10a0e6b-4f32-40ae-8896-6f45a3790cde"],

Cell[BoxData[
 RowBox[{"MakeUNET", "[", 
  RowBox[{"1", ",", "8", ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"128", ",", "128"}], "}"}], ",", 
   RowBox[{"DropOutRate", "\[Rule]", ".5"}], ",", 
   RowBox[{"BlockType", "\[Rule]", "\"\<DenseNet\>\""}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7462521277782135`*^9, 3.746252137151247*^9}, 
   3.7488686441228127`*^9, {3.7488699979347563`*^9, 3.7488699980450597`*^9}, {
   3.749873446537406*^9, 3.7498734478017707`*^9}, 3.752236572580288*^9, {
   3.8388693729584975`*^9, 3.8388693735818653`*^9}, 3.8396568199240036`*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"ae4bf7b0-fe1c-439e-8188-624c257a1963"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Describe UNET", "Subsection",
 CellChangeTimes->{{3.745075168901682*^9, 3.7450751811326494`*^9}, {
  3.7462521442250814`*^9, 
  3.746252151356104*^9}},ExpressionUUID->"76f5f44a-4849-492f-91b6-\
2840ffd5e759"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"style", "=", 
   RowBox[{"{", 
    RowBox[{"Bold", ",", 
     RowBox[{"TextAlignment", "\[Rule]", "Center"}], ",", 
     RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}]}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"lab", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Style", "[", 
      RowBox[{"#", ",", "style"}], "]"}], "&"}], "/@", 
    RowBox[{"{", 
     RowBox[{
     "\"\<n or (n, r)\>\"", ",", "\[IndentingNewLine]", " ", "\"\<Unet\>\"", 
      ",", " ", "\"\<UResNet\>\"", ",", " ", "\"\<ResNet\>\"", ",", " ", 
      "\"\<UDenseNet\>\"", ",", " ", "\"\<DenseNet\>\""}], "}"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.750238030365168*^9, 3.7502380525341215`*^9}, {
  3.7502547660365443`*^9, 3.750254783937169*^9}},
 CellLabel->"In[21]:=",ExpressionUUID->"e9d3eac5-b44d-46ba-bec8-b2559cec9e1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CountConv", "=", 
   RowBox[{
    RowBox[{"Count", "[", 
     RowBox[{
      RowBox[{"Head", "/@", 
       RowBox[{"Information", "[", 
        RowBox[{"#", ",", "\"\<LayersList\>\""}], "]"}]}], ",", 
      "ConvolutionLayer"}], "]"}], "&"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7457409730800104`*^9, 3.745740974619593*^9}, {
  3.7457429124905024`*^9, 3.7457429187274704`*^9}, {3.7457439135013013`*^9, 
  3.7457439178679457`*^9}, {3.838869513120454*^9, 3.838869515855929*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"aa44630a-691e-45b3-bd9f-cbadf2fdcdd1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "parameters", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"dim2D", "=", 
     RowBox[{"{", 
      RowBox[{"112", ",", "112"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"dim3D", "=", 
     RowBox[{"{", 
      RowBox[{"32", ",", "112", ",", "112"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"nchan", ",", "nclass"}], "}"}], "=", 
     RowBox[{"{", 
      RowBox[{"4", ",", "8"}], "}"}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{
    RowBox[{"dep", "=", 
     RowBox[{"{", 
      RowBox[{"8", ",", "16", ",", "24", ",", "32", ",", "48", ",", "64"}], 
      "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"depD", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"2", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"4", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"6", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"8", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"12", ",", "4"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"16", ",", "4"}], "}"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"par", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ToString", "[", 
         RowBox[{"dep", "[", 
          RowBox[{"[", "i", "]"}], "]"}], "]"}], "<>", "\"\< or (\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"depD", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], "<>", "\"\<,\>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"depD", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "<>", "\"\<)\>\""}], 
       ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "dep", "]"}]}], "}"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.745320645743224*^9, 3.745320689164191*^9}, {
   3.7453207467766867`*^9, 3.745320748332337*^9}, {3.7499590656706057`*^9, 
   3.7499590766482816`*^9}, {3.750238154926571*^9, 3.7502381565027323`*^9}, {
   3.750238196582364*^9, 3.7502382007855473`*^9}, {3.75023838646856*^9, 
   3.7502383866269803`*^9}, 3.750254859891078*^9},
 CellLabel->"In[24]:=",ExpressionUUID->"7f5059a8-2613-4aa5-a092-89b68762a5b0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"2", "D", " ", "UNET", " ", "generation"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"par2D", "=", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"nets2D", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MakeUNET", "[", 
             RowBox[{"nchan", ",", "nclass", ",", " ", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "dim2D", ",", 
              RowBox[{"BlockType", "\[Rule]", "#1"}]}], " ", "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<UNET\>\"", ",", "\"\<UResNet\>\"", ",", "\"\<ResNet\>\"", 
               ",", "\"\<UDenseNet\>\"", ",", "\"\<DenseNet\>\""}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
              "dep", ",", "dep", ",", "dep", ",", "depD", ",", "depD"}], 
              "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Information", "[", 
              RowBox[{"#", ",", "\"\<ArraysTotalElementCount\>\""}], "]"}], 
             "&"}], "/@", "nets2D"}]}], "}"}]}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "dep", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tab1", "=", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<2D Nets - Numer of Array Elementes\>\"", ",", "style"}], "]"}],
          ",", 
         RowBox[{"TableForm", "[", 
          RowBox[{"par2D", ",", 
           RowBox[{"TableHeadings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", "lab"}], "}"}]}], ",", 
           RowBox[{"TableAlignments", "\[Rule]", "Right"}]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.745075188567417*^9, 3.7450751899881926`*^9}, {
   3.7450752456030893`*^9, 3.7450752725005655`*^9}, {3.74507534392449*^9, 
   3.7450753464010396`*^9}, {3.745118023019107*^9, 3.7451183513110027`*^9}, {
   3.7451201237098413`*^9, 3.745120126132266*^9}, {3.7451204912112007`*^9, 
   3.745120497773902*^9}, {3.745135390604102*^9, 3.7451353908914146`*^9}, 
   3.7451354277237024`*^9, {3.7453206689877005`*^9, 3.745320696907543*^9}, {
   3.745742877386057*^9, 3.7457429041682653`*^9}, {3.7457429389535522`*^9, 
   3.7457430208882217`*^9}, {3.7457430565855417`*^9, 3.745743092650964*^9}, 
   3.745743123690982*^9, 3.7457434253459444`*^9, {3.7457434709599953`*^9, 
   3.74574347111541*^9}, 3.7457437027188053`*^9, {3.7457437692771034`*^9, 
   3.745743774731105*^9}, {3.745743878350533*^9, 3.7457439084439263`*^9}, 
   3.745744029388075*^9, 3.749473670678999*^9, {3.749473751990258*^9, 
   3.7494737821808043`*^9}, {3.749473872258727*^9, 3.7494738913933372`*^9}, {
   3.749873616386285*^9, 3.7498736518696966`*^9}, {3.749921137352709*^9, 
   3.749921159232922*^9}, {3.749921219330812*^9, 3.7499212734808807`*^9}, {
   3.749921548750867*^9, 3.7499215509707413`*^9}, 3.749921649801681*^9, {
   3.7499594728524704`*^9, 3.7499595208906574`*^9}, {3.749960485275803*^9, 
   3.749960506608807*^9}, {3.7502371021382303`*^9, 3.750237117059963*^9}, {
   3.750237209682354*^9, 3.7502372441731186`*^9}, {3.7502372864325504`*^9, 
   3.7502373027218857`*^9}, 3.75023734231623*^9, {3.750237441333665*^9, 
   3.750237447759762*^9}, {3.750237532961443*^9, 3.750237651183977*^9}, {
   3.7502377263011756`*^9, 3.7502377926496944`*^9}, 3.750237909933755*^9, {
   3.7502379720540037`*^9, 3.750237979928994*^9}, {3.750238073582121*^9, 
   3.750238074189771*^9}, {3.7502381223528757`*^9, 3.7502381224581947`*^9}, {
   3.7502382034055176`*^9, 3.7502382159078183`*^9}, {3.750238311479049*^9, 
   3.750238340175428*^9}, {3.7502384040352964`*^9, 3.75023840725386*^9}, {
   3.7502384417075243`*^9, 3.7502384459117093`*^9}, 3.75039231907106*^9, 
   3.7522365758560705`*^9, 3.838869521617669*^9},
 CellLabel->"In[30]:=",ExpressionUUID->"b761a02b-0a72-4ab9-963b-f19b4aeedd21"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"3", "D", " ", "UNET", " ", "generation"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"par3D", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"nets3D", "=", 
         RowBox[{"MapThread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"MakeUNET", "[", 
             RowBox[{"nchan", ",", "nclass", ",", " ", 
              RowBox[{"#2", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", "dim3D", ",", 
              RowBox[{"BlockType", "\[Rule]", "#1"}]}], " ", "]"}], "&"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
              "\"\<UNET\>\"", ",", "\"\<UResNet\>\"", ",", "\"\<ResNet\>\"", 
               ",", "\"\<UDenseNet\>\"", ",", "\"\<DenseNet\>\""}], "}"}], 
             ",", 
             RowBox[{"{", 
              RowBox[{
              "dep", ",", "dep", ",", "dep", ",", "depD", ",", "depD"}], 
              "}"}]}], "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"par", "[", 
            RowBox[{"[", "i", "]"}], "]"}], ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Information", "[", 
              RowBox[{"#", ",", "\"\<ArraysTotalElementCount\>\""}], "]"}], 
             "&"}], "/@", "nets3D"}]}], "}"}]}]}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "dep", "]"}]}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tab2", "=", 
     RowBox[{"Column", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{
          "\"\<3D Nets - Numer of Array Elementes\>\"", ",", "style"}], "]"}],
          ",", 
         RowBox[{"TableForm", "[", 
          RowBox[{"par3D", ",", 
           RowBox[{"TableHeadings", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"None", ",", "lab"}], "}"}]}], ",", 
           RowBox[{"TableAlignments", "\[Rule]", "Right"}]}], "]"}]}], "}"}], 
       ",", 
       RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.745075188567417*^9, 3.7450751899881926`*^9}, {
   3.7450752456030893`*^9, 3.7450752725005655`*^9}, {3.74507534392449*^9, 
   3.7450753464010396`*^9}, {3.745118023019107*^9, 3.7451182447236233`*^9}, {
   3.745118275382165*^9, 3.745118277876796*^9}, {3.7451183562411404`*^9, 
   3.745118356884856*^9}, {3.745118588692522*^9, 3.745118593005641*^9}, {
   3.7451205027119074`*^9, 3.745120511069149*^9}, {3.745135378920534*^9, 
   3.745135408761692*^9}, {3.745320698684863*^9, 3.745320707689217*^9}, {
   3.74574349284871*^9, 3.745743593673278*^9}, {3.7457437065550375`*^9, 
   3.745743707147167*^9}, 3.7457437813548136`*^9, {3.7457439305559254`*^9, 
   3.7457439402977514`*^9}, {3.745744036234914*^9, 3.7457440511346035`*^9}, 
   3.745744114798486*^9, {3.7457442005089407`*^9, 3.7457442041853065`*^9}, {
   3.749960075911649*^9, 3.7499602697624407`*^9}, 3.749960379443901*^9, {
   3.7499604099309645`*^9, 3.749960411818965*^9}, 3.7499605119880075`*^9, 
   3.7502371276110015`*^9, {3.7502373127605953`*^9, 3.750237341494042*^9}, {
   3.7502378068584995`*^9, 3.750237932596025*^9}, {3.7502379814520063`*^9, 
   3.75023798451118*^9}, {3.7502380781111994`*^9, 3.750238078970457*^9}, 
   3.7502381316676702`*^9, {3.7502382198933926`*^9, 3.750238222725957*^9}, 
   3.75023841584271*^9, {3.750238448007309*^9, 3.750238449968502*^9}, {
   3.7503923144578133`*^9, 3.7503923221451764`*^9}, 3.752236577246789*^9, {
   3.8388697823357134`*^9, 3.8388697840905943`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"aed1bab8-edac-4d92-9541-4eccb772481b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"layers2D", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CountConv", "[", "#", "]"}], "]"}], "&"}], "/@", "nets2D"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"layers3D", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ToString", "[", 
      RowBox[{"CountConv", "[", "#", "]"}], "]"}], "&"}], "/@", "nets3D"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"layers", "=", 
   RowBox[{"Column", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Style", "[", 
        RowBox[{"\"\<Number of convolution layers\>\"", ",", "style"}], "]"}],
        ",", 
       RowBox[{"Style", "[", 
        RowBox[{
         RowBox[{"\"\<1)  UNet: \>\"", "<>", 
          RowBox[{"layers2D", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "<>", "\"\<    2)  UResNet: \>\"", 
          "<>", 
          RowBox[{"layers2D", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "<>", "\[IndentingNewLine]", 
          "\"\<    3)  ResNet: \>\"", "<>", 
          RowBox[{"layers2D", "[", 
           RowBox[{"[", "3", "]"}], "]"}], "<>", 
          "\"\<    4)  UDenseNet: \>\"", "<>", 
          RowBox[{"layers2D", "[", 
           RowBox[{"[", "4", "]"}], "]"}], "<>", "\"\<    5)  DenseNet: \>\"",
           "<>", 
          RowBox[{"layers2D", "[", 
           RowBox[{"[", "5", "]"}], "]"}]}], ",", "style"}], "]"}]}], "}"}], 
     ",", 
     RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.750237455686854*^9, 3.7502375178973646`*^9}, {
   3.750237654582017*^9, 3.750237714007467*^9}, {3.750237844645029*^9, 
   3.750237848258684*^9}, {3.750238005676456*^9, 3.750238025573425*^9}, 
   3.7502380614167786`*^9, {3.7502382411960597`*^9, 3.7502382740414467`*^9}, {
   3.750238463819352*^9, 3.7502384704880967`*^9}, {3.7502385086135283`*^9, 
   3.750238509977158*^9}, 3.7502385874462643`*^9, {3.8388709514628844`*^9, 
   3.8388709757020226`*^9}, {3.838871008071648*^9, 3.8388710341998744`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"07ad3080-a62c-4a34-acaa-ac7731a8deaf"],

Cell[BoxData[
 RowBox[{"Column", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "layers", ",", "\"\<\>\"", ",", "tab1", ",", "\"\<\>\"", ",", "tab2"}], 
    "}"}], ",", 
   RowBox[{"Alignment", "\[Rule]", "Center"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.838869959173149*^9, 3.8388699916486235`*^9}, 
   3.8388725663073015`*^9},
 CellLabel->"In[37]:=",ExpressionUUID->"13c62ff2-efd8-49ab-9e9d-4cee405fe2c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Examples of Test Data", "Subsection",
 CellChangeTimes->{{3.7362393807238426`*^9, 3.736239385696301*^9}, {
  3.736781314388665*^9, 
  3.7367813242900867`*^9}},ExpressionUUID->"82f847f8-af86-4335-b010-\
0b525865d7eb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", ",", "label"}], "}"}], "=", 
   RowBox[{"CreateImage1", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MakeChannelImage", "[", "data", "]"}], ",", 
    RowBox[{"Image", "[", "label", "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{
  3.7367816504903927`*^9, {3.7367817167059765`*^9, 3.736781727658814*^9}, {
   3.736927652949238*^9, 3.7369276814355545`*^9}, 3.7369277130361896`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"836a86c0-c7ac-4ccb-bfdc-9ed48356a9a9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", ",", "label"}], "}"}], "=", 
   RowBox[{"CreateImage2", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MakeChannelImage", "[", "data", "]"}], ",", 
    RowBox[{"MakeClassImage", "[", "label", "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.736781467769794*^9, 3.7367814997244406`*^9}, {
  3.736781629243444*^9, 3.736781640301976*^9}, {3.736781711889228*^9, 
  3.7367817338639455`*^9}, {3.7369276713783712`*^9, 3.736927717853346*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"68d492e8-df7c-44dd-bd79-7202d31beee2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", ",", "label"}], "}"}], "=", 
   RowBox[{"CreateImage3", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MakeChannelImage", "[", "data", "]"}], ",", 
    RowBox[{"MakeClassImage", "[", 
     RowBox[{"label", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "4"}], "}"}]}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.736781687566295*^9, 3.7367817370508847`*^9}, {
  3.7367819602502584`*^9, 3.736781962830623*^9}, {3.736927722362133*^9, 
  3.736927735750816*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"f0cb3ed1-b97f-4cd2-8a80-5c47ebc56121"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data", ",", "label"}], "}"}], "=", 
   RowBox[{"CreateImage4", "[", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Flatten", "@", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"MakeChannelImage", "[", "data", "]"}], ",", 
    RowBox[{"MakeClassImage", "[", 
     RowBox[{"label", ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", "4"}], "}"}]}], "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.7367818340732017`*^9, 3.7367818582521353`*^9}, {
   3.736781934422789*^9, 3.7367819371755004`*^9}, 3.7369277457844744`*^9},
 CellLabel->"In[10]:=",ExpressionUUID->"970c22ac-cfcc-428b-a387-451a782d95b5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Cases 1: 1 channel - 1 classes", "Subsection",
 CellChangeTimes->{{3.7362393923808303`*^9, 3.736239395951547*^9}, {
   3.7362558963969927`*^9, 3.7362558973125873`*^9}, {3.73692725042663*^9, 
   3.736927264403715*^9}, 
   3.7369312394201775`*^9},ExpressionUUID->"f0a4d34d-373a-4eff-a8eb-\
07e59aabf187"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "test", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data1", ",", "label1"}], "}"}], "=", 
    RowBox[{"MakeTestImages", "[", 
     RowBox[{"100", ",", "1"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736223942920128*^9, 3.736223950732706*^9}, {
  3.7362240856355734`*^9, 3.736224145327012*^9}, {3.736927241127551*^9, 
  3.7369272478575377`*^9}, {3.736927362836816*^9, 3.736927368244885*^9}, {
  3.7390080753894987`*^9, 3.7390080757705173`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"5f25cc7b-42de-4d1f-a5d8-82a79441e73b"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"split", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "train1", ",", "valid1", ",", "testData1", ",", "testLabel1", ",", 
      "order1"}], "}"}], "=", 
    RowBox[{"SplitTrainData", "[", 
     RowBox[{"data1", ",", "label1"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7369272873624334`*^9, 3.736927293563071*^9}, {
  3.736930975620717*^9, 3.7369309783211355`*^9}, {3.7458378523259745`*^9, 
  3.745837853299219*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"c77bf1f8-94d6-421e-8d4c-e02cd6b94c6e"],

Cell[CellGroupData[{

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Nuber of Samples in each set: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"70", ",", "20", ",", "10"}], "}"}]}],
  SequenceForm["Nuber of Samples in each set: ", {70, 20, 10}],
  Editable->False]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.7369273715846357`*^9, 3.7369296106869926`*^9, 3.736930984183799*^9, 
   3.739005903007616*^9, 3.739008080196916*^9, 3.740237128366847*^9, 
   3.740237245570287*^9, 3.7450514922146053`*^9, 3.7450550321278915`*^9, 
   3.745059954687684*^9, {3.7458378276045103`*^9, 3.7458378536922855`*^9}, 
   3.7458384356454573`*^9, 3.745919326680462*^9, 3.7462541195914516`*^9, 
   3.746254314819189*^9, 3.848564832271124*^9, {3.848565742929331*^9, 
   3.848565747645337*^9}},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"3b8b8709-b225-40d1-a3b5-3a7b39b24eaa"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Dimensions data: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"100", ",", "1", ",", "128", ",", "128"}], "}"}], 
   "\[InvisibleSpace]", "\<\" - Dimensions label: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"100", ",", "128", ",", "128"}], "}"}]}],
  SequenceForm[
  "Dimensions data: ", {100, 1, 128, 128}, " - Dimensions label: ", {100, 128,
    128}],
  Editable->False]], "Print",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{
  3.7369273715846357`*^9, 3.7369296106869926`*^9, 3.736930984183799*^9, 
   3.739005903007616*^9, 3.739008080196916*^9, 3.740237128366847*^9, 
   3.740237245570287*^9, 3.7450514922146053`*^9, 3.7450550321278915`*^9, 
   3.745059954687684*^9, {3.7458378276045103`*^9, 3.7458378536922855`*^9}, 
   3.7458384356454573`*^9, 3.745919326680462*^9, 3.7462541195914516`*^9, 
   3.746254314819189*^9, 3.848564832271124*^9, {3.848565742929331*^9, 
   3.8485657476214*^9}},
 CellLabel->
  "During evaluation of \
In[14]:=",ExpressionUUID->"79836205-c345-4630-b789-d0a96ac11da4"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"Nuber of Samples in each set: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"70", ",", "20", ",", "10"}], "}"}]}],
  SequenceForm["Nuber of Samples in each set: ", {70, 20, 10}],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.7369273715846357`*^9, 3.7369296106869926`*^9, 3.736930984183799*^9, 
   3.739005903007616*^9, 3.739008080196916*^9, 3.740237128366847*^9, 
   3.740237245570287*^9, 3.7450514922146053`*^9, 3.7450550321278915`*^9, 
   3.745059954687684*^9, {3.7458378276045103`*^9, 3.7458378536922855`*^9}, 
   3.7458384356454573`*^9, 3.745919326680462*^9, 3.7462541195914516`*^9, 
   3.746254314819189*^9, 3.848564832281089*^9},
 CellLabel->
  "During evaluation of \
In[47]:=",ExpressionUUID->"854aa1dc-fd92-4871-81aa-3532bbe31014"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"visualize", " ", "the", " ", "test", " ", "data"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData1", ",", "testLabel1", ",", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "3"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "False"}], ",", 
    RowBox[{"StepSize", "\[Rule]", "2"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.736927294960096*^9, 3.736927350306945*^9}, {
   3.7369309811899242`*^9, 3.7369309821138906`*^9}, 3.739008292259966*^9},
 CellLabel->"In[15]:=",ExpressionUUID->"e2cf3ad1-b30f-4d54-b606-a90ee104565a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"train", " ", "the", " ", "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"net1", ",", "trained1", ",", "netTrained1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"result1", ",", "iou1"}], "}"}]}], "}"}], "=", 
     RowBox[{"TrainUNET", "[", 
      RowBox[{"train1", ",", "valid1", ",", 
       RowBox[{"{", 
        RowBox[{"testData1", ",", "testLabel1"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"TargetDevice", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<GPU\>\"", ",", "1"}], "}"}]}], ",", 
       RowBox[{"MaxTrainingRounds", "\[Rule]", "250"}], ",", 
       RowBox[{"NetParameters", "\[Rule]", "16"}], ",", 
       RowBox[{"DropOutRate", "\[Rule]", ".5"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MakeNetPlots", "[", "trained1", "]"}]}]}]], "Input",
 CellChangeTimes->{
  3.736421957082659*^9, {3.7364787021657953`*^9, 3.736478710954377*^9}, {
   3.736481023645641*^9, 3.736481032731614*^9}, 3.736481294607136*^9, {
   3.73648436196591*^9, 3.736484371040115*^9}, {3.736484494879651*^9, 
   3.736484508232232*^9}, {3.736492049823741*^9, 3.736492049933117*^9}, 
   3.7366641414270287`*^9, {3.736666630235386*^9, 3.7366666326731224`*^9}, {
   3.736666665921709*^9, 3.7366666659842043`*^9}, {3.736782069126108*^9, 
   3.7367820714276886`*^9}, {3.736782131535329*^9, 3.736782138593763*^9}, {
   3.7367840948657007`*^9, 3.736784122051338*^9}, {3.736784369340965*^9, 
   3.736784370450262*^9}, 3.7368509842315054`*^9, {3.7368510297748404`*^9, 
   3.73685103357183*^9}, {3.736851069291587*^9, 3.7368510698386474`*^9}, 
   3.7369272841698074`*^9, {3.7369273829543734`*^9, 3.736927419357041*^9}, {
   3.736927452589646*^9, 3.7369274718429365`*^9}, {3.7369309871479635`*^9, 
   3.7369309972670712`*^9}, {3.7390076318144403`*^9, 
   3.7390076318790383`*^9}, {3.7390078119937935`*^9, 3.739007812085964*^9}, 
   3.739007968364256*^9, {3.73900800500515*^9, 3.739008007593692*^9}, 
   3.7390081683841963`*^9, {3.745050960782175*^9, 3.745050964377982*^9}, {
   3.7450552393979287`*^9, 3.745055291962062*^9}, {3.7450599001073074`*^9, 
   3.7450599113207164`*^9}, {3.7458380180867214`*^9, 
   3.7458380181849833`*^9}, {3.7459193161712837`*^9, 3.745919328393549*^9}, 
   3.848566022111797*^9, {3.848566052169479*^9, 3.8485660532386613`*^9}, {
   3.8485661015421906`*^9, 
   3.8485661051604867`*^9}},ExpressionUUID->"e628eb92-cfc7-44bc-8c58-\
0ac81605d1ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "layers", " ", "of", " ", "the", " ", 
    "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"VisualizeUNET2D", "[", 
   RowBox[{"testData1", ",", "netTrained1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7367635744536123`*^9, 3.736763586834174*^9}, {
   3.736764000182431*^9, 3.7367640089543753`*^9}, 3.7367643725344725`*^9, {
   3.7367652678051596`*^9, 3.7367652681687517`*^9}, {3.736782988251666*^9, 
   3.7367829947281933`*^9}, {3.7367832730906196`*^9, 3.736783273431922*^9}, {
   3.736929754722163*^9, 3.7369297662008657`*^9}, 3.7390059276441746`*^9, 
   3.7390077206752834`*^9},
 CellLabel->"In[18]:=",ExpressionUUID->"18a352a1-5023-43ff-8324-5c2f5303f12b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "test", " ", "data", " ", "witout", " ", 
    "diff", " ", "image"}], "*)"}], "\n", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData1", ",", "testLabel1", ",", "result1", ",", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "3"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "False"}], ",", 
    RowBox[{"StepSize", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.736927413966957*^9, 3.7369274161629543`*^9}, {
  3.736927886167271*^9, 3.7369278959829507`*^9}, {3.736928059326234*^9, 
  3.7369280621129756`*^9}, {3.7369310203321457`*^9, 3.7369310222404804`*^9}, {
  3.745837930260993*^9, 3.745837938018444*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"b0544004-dc84-4858-852b-930cdc49ac1d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "test", " ", "data", " ", "with", " ", 
    "diff", " ", "image"}], "*)"}], "\n", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData1", ",", "testLabel1", ",", "result1", ",", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "3"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "True"}], ",", 
    RowBox[{"StepSize", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.736927413966957*^9, 3.7369274161629543`*^9}, {
  3.736927886167271*^9, 3.7369278959829507`*^9}, {3.736928059326234*^9, 
  3.736928085569493*^9}, {3.7369281526312003`*^9, 3.7369281551249776`*^9}, {
  3.7369310297366257`*^9, 3.736931032258111*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"d42a3795-8587-44e7-897d-9edcd48c49eb"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Case 2: 1 channel - 2 classes", "Subsection",
 CellChangeTimes->{{3.7362559025269456`*^9, 3.7362559070878487`*^9}, {
   3.736927271462489*^9, 3.7369272795614557`*^9}, 
   3.736931238649115*^9},ExpressionUUID->"ae8a8131-f090-4256-99d8-\
202947e3efc1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "test", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data2", ",", "label2"}], "}"}], "=", 
    RowBox[{"MakeTestImages", "[", 
     RowBox[{"100", ",", "2"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736223942920128*^9, 3.736223950732706*^9}, {
   3.7362240856355734`*^9, 3.736224155216504*^9}, 3.736227983792309*^9, {
   3.736929696262554*^9, 3.736929697022158*^9}, {3.736929732032507*^9, 
   3.736929732126422*^9}, {3.7450516089183645`*^9, 3.7450516092863464`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"b5a917a9-f063-4532-b914-d9977b90bb50"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"split", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "train2", ",", "valid2", ",", "testData2", ",", "testLabel2", ",", 
      "order"}], "}"}], "=", 
    RowBox[{"SplitTrainData", "[", 
     RowBox[{"data2", ",", "label2"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7369297075753202`*^9, 3.736929708218224*^9}, {
  3.7369301009356327`*^9, 3.7369301039153814`*^9}, {3.745838615322497*^9, 
  3.745838616068084*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"7d59c487-cc4e-4c58-95d2-35721084a132"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"train", " ", "the", " ", "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"net2", ",", "trained2", ",", "netTrained2"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"result2", ",", "iou2"}], "}"}]}], "}"}], "=", 
     RowBox[{"TrainUNET", "[", 
      RowBox[{"train2", ",", "valid2", ",", 
       RowBox[{"{", 
        RowBox[{"testData2", ",", "testLabel2"}], "}"}], ",", 
       RowBox[{"BatchSize", "\[Rule]", "50"}], ",", "\[IndentingNewLine]", 
       RowBox[{"TargetDevice", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<GPU\>\"", ",", "1"}], "}"}]}], ",", 
       RowBox[{"MaxTrainingRounds", "\[Rule]", "250"}], ",", 
       RowBox[{"NetParameters", "\[Rule]", "16"}], ",", 
       RowBox[{"DropOutRate", "\[Rule]", "0.5"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"MakeNetPlots", "[", "trained2", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.736784749064206*^9, 3.7367847495978036`*^9}, 
   3.7368431144347076`*^9, 3.7368431721095114`*^9, 3.7368432362104325`*^9, {
   3.7368511308398733`*^9, 3.7368511312771254`*^9}, {3.7369296993855*^9, 
   3.7369297234740033`*^9}, {3.7369298003682275`*^9, 3.736929800665102*^9}, {
   3.7369301057657566`*^9, 3.7369301191445885`*^9}, {3.745051626780969*^9, 
   3.745051639925393*^9}, {3.745059907337956*^9, 3.745059914696717*^9}, {
   3.745838585461971*^9, 3.7458385855366793`*^9}, {3.7459193842182665`*^9, 
   3.7459193858990383`*^9}, {3.7459197887156353`*^9, 
   3.7459197926491585`*^9}, {3.8485668908278275`*^9, 3.848566921966338*^9}},
 CellLabel->"In[4]:=",ExpressionUUID->"e011104e-23ba-49d9-89cd-0622d4202e2e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "layers", " ", "of", " ", "the", " ", 
    "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"VisualizeUNET2D", "[", 
   RowBox[{"testData2", ",", "netTrained2"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7367635744536123`*^9, 3.736763586834174*^9}, {
   3.736764000182431*^9, 3.7367640089543753`*^9}, 3.7367643725344725`*^9, {
   3.7367652678051596`*^9, 3.7367652681687517`*^9}, {3.736782988251666*^9, 
   3.7367829947281933`*^9}, {3.7367832730906196`*^9, 3.736783273431922*^9}, {
   3.7369297743840933`*^9, 3.736929775185273*^9}, {3.7369301258744745`*^9, 
   3.736930130414729*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"eba55e35-2f18-4a6f-9d99-93a7d09cf581"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "test", " ", "data", " ", "witout", " ", 
    "diff", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData2", ",", " ", "testLabel2", ",", "result2", ",", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "3"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "True"}], ",", 
    RowBox[{"StepSize", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.736663921832626*^9, 3.736663933539857*^9}, {
   3.7366666492813053`*^9, 3.736666649468827*^9}, {3.736666724079117*^9, 
   3.736666724157335*^9}, 3.7367820920110397`*^9, {3.7367827322697463`*^9, 
   3.736782741183428*^9}, {3.736784677305621*^9, 3.736784679932448*^9}, {
   3.7369297985876594`*^9, 3.736929819951904*^9}, {3.7369301267761793`*^9, 
   3.736930138221402*^9}, {3.7450517386157637`*^9, 3.7450517391071434`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"25af0373-c2c0-46f7-bf72-f026e1a97ed9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Case 3: 1 channel - 4 classes", "Subsection",
 CellChangeTimes->{{3.7362559139392004`*^9, 3.7362559217185698`*^9}, {
  3.7364111182974825`*^9, 3.7364111208781576`*^9}, {3.7369312255927057`*^9, 
  3.736931234575971*^9}},ExpressionUUID->"07eca103-b55f-49fe-a389-\
80f1a5adc8a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "test", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data3", ",", "label3"}], "}"}], "=", 
    RowBox[{"MakeTestImages", "[", 
     RowBox[{"150", ",", "3"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736223942920128*^9, 3.736223950732706*^9}, {
   3.7362240856355734`*^9, 3.736224155216504*^9}, {3.736227983792309*^9, 
   3.7362279930816565`*^9}, 3.736231119422229*^9, {3.736233288896597*^9, 
   3.736233289263381*^9}, {3.736234179823323*^9, 3.7362341801982365`*^9}, {
   3.736234980977395*^9, 3.7362349812326527`*^9}, {3.736236837028271*^9, 
   3.7362368376220875`*^9}, {3.7362374690219507`*^9, 
   3.7362374694907565`*^9}, {3.7362653551800127`*^9, 3.736265365468457*^9}, {
   3.736334131914491*^9, 3.7363341325211687`*^9}, {3.7364108303651233`*^9, 
   3.736410831114983*^9}, {3.7364114350821204`*^9, 3.7364114357890396`*^9}, {
   3.736479711857704*^9, 3.7364797136401186`*^9}, {3.7367584223632197`*^9, 
   3.7367584227072926`*^9}, {3.7367613999992657`*^9, 3.736761400202159*^9}, {
   3.7369298528488345`*^9, 3.736929854023517*^9}, {3.736929886623393*^9, 
   3.7369298871880236`*^9}, {3.7369299495873294`*^9, 
   3.7369299499073954`*^9}, {3.7369325989609065`*^9, 
   3.7369325990081325`*^9}, {3.739009143228804*^9, 3.739009143594188*^9}, {
   3.7451420078097367`*^9, 3.7451420081267934`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"559b218e-8545-4e88-8a6a-59431ce4a153"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"data", " ", "augmentation"}], ",", " ", 
    RowBox[{
    "increase", " ", "the", " ", "data", " ", "by", " ", "flipping", " ", 
     "and", " ", "rotating"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "flips", " ", "and", " ", "rotations"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"data3R", "=", 
     RowBox[{"RotateFlip", "[", 
      RowBox[{"data3", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"label3R", "=", 
     RowBox[{"RotateFlip", "[", 
      RowBox[{"label3", "[", 
       RowBox[{"[", 
        RowBox[{"1", ";;", "2"}], "]"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ShowChannelClassData", "[", 
    RowBox[{"data3R", ",", "label3R", ",", " ", 
     RowBox[{"NumberRowItems", "\[Rule]", "4"}], ",", 
     RowBox[{"MakeDifferenceImage", "\[Rule]", "False"}], ",", 
     RowBox[{"StepSize", "\[Rule]", "1"}], ",", 
     RowBox[{"ImageSize", "\[Rule]", "200"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7369300107445855`*^9, 3.736930057016168*^9}, {
  3.736930170262787*^9, 3.7369302050359063`*^9}, {3.736930244848497*^9, 
  3.7369302454092283`*^9}, {3.7369307889532337`*^9, 3.7369307914152718`*^9}, {
  3.7369316953807335`*^9, 3.7369317000584135`*^9}, {3.736931818136875*^9, 
  3.7369318262568827`*^9}, {3.7459197556912823`*^9, 3.7459197560085196`*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"b96d6ba5-2b34-4463-9bb7-4f36dafed980"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"split", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "train3", ",", "valid3", ",", "testData3", ",", "testLabel3", ",", 
      "order3"}], "}"}], "=", 
    RowBox[{"SplitTrainData", "[", 
     RowBox[{"data3", ",", "label3", ",", 
      RowBox[{"AugmentTrainData", "\[Rule]", "False"}]}], "]"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.736784889974166*^9, 3.7367849429111147`*^9}, 
   3.736843395572187*^9, 3.7368436210199814`*^9, 3.736843696045906*^9, {
   3.7368512327918215`*^9, 3.73685123346352*^9}, {3.736855011806996*^9, 
   3.73685501202577*^9}, {3.7369298591060915`*^9, 3.7369298663299513`*^9}, {
   3.7369309674995594`*^9, 3.736930969569811*^9}, {3.736931039580819*^9, 
   3.736931043628154*^9}, {3.7369312932818484`*^9, 3.7369313131162806`*^9}, {
   3.745142002115037*^9, 3.7451420037120447`*^9}, {3.7458376897339168`*^9, 
   3.745837691011326*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"60d35187-9ae0-44fc-bb7e-d20386da86c6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"train", " ", "the", " ", "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"net3", ",", "trained3", ",", "netTrained3"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"result3", ",", "iou3"}], "}"}]}], "}"}], "=", 
    RowBox[{"TrainUNET", "[", 
     RowBox[{"train3", ",", "valid3", ",", 
      RowBox[{"{", 
       RowBox[{"testData3", ",", "testLabel3"}], "}"}], ",", 
      RowBox[{"BatchSize", "\[Rule]", "30"}], ",", "\[IndentingNewLine]", 
      RowBox[{"TargetDevice", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<GPU\>\"", ",", "1"}], "}"}]}], ",", 
      RowBox[{"MaxTrainingRounds", "\[Rule]", "100"}], ",", 
      RowBox[{"NetParameters", "\[Rule]", "32"}], ",", 
      RowBox[{"BlockType", "\[Rule]", "\"\<ResNet\>\""}], ",", 
      RowBox[{"DropOutRate", "\[Rule]", "0.25"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736929877040193*^9, 3.736929882687579*^9}, {
   3.7369310469979916`*^9, 3.7369310630423207`*^9}, {3.736931132420038*^9, 
   3.7369311325293903`*^9}, {3.736932063745055*^9, 3.73693206423477*^9}, {
   3.7450517670806932`*^9, 3.745051793364732*^9}, {3.745053156716096*^9, 
   3.7450531568108854`*^9}, 3.7450531890675974`*^9, {3.7450598852103615`*^9, 
   3.745059885310128*^9}, {3.74506014927607*^9, 3.7450601554347496`*^9}, {
   3.7450602101232204`*^9, 3.7450602103757715`*^9}, 3.74512273679707*^9, {
   3.745135503531702*^9, 3.7451355075474434`*^9}, {3.745141948483966*^9, 
   3.745141981055852*^9}, {3.7451422075704904`*^9, 3.7451422132821407`*^9}, {
   3.745841036856451*^9, 3.7458410551888695`*^9}, {3.74584130684523*^9, 
   3.745841313621033*^9}, {3.7458413618672295`*^9, 3.7458413783575134`*^9}, {
   3.745841552014129*^9, 3.745841563432193*^9}, {3.745841891834644*^9, 
   3.745841897095703*^9}, {3.745918555881321*^9, 3.7459185649346347`*^9}, {
   3.7459192607167788`*^9, 3.7459192649239855`*^9}, {3.7459200291971226`*^9, 
   3.745920030250965*^9}, {3.7459208535222387`*^9, 3.745920856730833*^9}, {
   3.746255694915741*^9, 3.746255700916711*^9}, {3.746255923144405*^9, 
   3.746255959461953*^9}, {3.749209252985916*^9, 3.7492092533364754`*^9}, {
   3.763444411152773*^9, 3.7634444257476797`*^9}, {3.848566330378167*^9, 
   3.8485663405539513`*^9}, {3.848566372284834*^9, 3.848566406265435*^9}, {
   3.8485665390514917`*^9, 3.848566539093354*^9}, {3.848566646275344*^9, 
   3.848566664265484*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"3b06b214-da8b-49f4-8dd6-9127f80c8428"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "layers", " ", "of", " ", "the", " ", 
    "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"VisualizeUNET2D", "[", 
   RowBox[{"testData3", ",", "netTrained3"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7367635744536123`*^9, 3.736763586834174*^9}, {
   3.736764000182431*^9, 3.7367640089543753`*^9}, 3.7367643725344725`*^9, {
   3.7367652678051596`*^9, 3.7367652681687517`*^9}, {3.736782988251666*^9, 
   3.7367829947281933`*^9}, {3.7367832730906196`*^9, 3.736783273431922*^9}, {
   3.7369310904001884`*^9, 3.7369311021137085`*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"1426dd22-e2b5-49c7-a999-33fe81b7b170"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "test", " ", "data", " ", "witout", " ", 
    "diff", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData3", ",", " ", "testLabel3", ",", " ", "result3", ",", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "3"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "True"}], ",", 
    RowBox[{"StepSize", "\[Rule]", "1"}]}], "]"}]}]], "Input",
 CellChangeTimes->{3.745142251701399*^9},
 CellLabel->"In[9]:=",ExpressionUUID->"a6d792fe-f1f2-4dfd-84f2-7dab9eca61a5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Case 4 : 3 channels - 4 classes", "Subsection",
 CellChangeTimes->{{3.736255937786428*^9, 3.736255942050702*^9}, {
   3.7368672510536203`*^9, 3.7368672561377573`*^9}, 3.7368673086760798`*^9, {
   3.7369332111824837`*^9, 
   3.7369332217501698`*^9}},ExpressionUUID->"964043c3-f1f7-4146-9417-\
e090d9b9606d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "test", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"data4", ",", "label4"}], "}"}], "=", 
    RowBox[{"MakeTestImages", "[", 
     RowBox[{"100", ",", "4"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736223942920128*^9, 3.736223950732706*^9}, {
  3.7362240856355734`*^9, 3.736224155216504*^9}, {3.736227983792309*^9, 
  3.7362280037391157`*^9}, {3.736411990457652*^9, 3.736411991279434*^9}, {
  3.7364815117213306`*^9, 3.7364815125701046`*^9}, {3.7369312511368146`*^9, 
  3.7369312535016336`*^9}, {3.7369329302140856`*^9, 3.7369329312180758`*^9}},
 CellLabel->"In[29]:=",ExpressionUUID->"125b3671-af9a-4048-a4a0-c53abca87d8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"split", " ", "the", " ", "data"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "train4", ",", "valid4", ",", "testData4", ",", "testLabel4", ",", 
      "order4"}], "}"}], "=", 
    RowBox[{"SplitTrainData", "[", 
     RowBox[{"data4", ",", "label4"}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.736092162506568*^9, 3.7360921717151403`*^9}, {
   3.736093115569694*^9, 3.7360931493970985`*^9}, {3.7360962453078156`*^9, 
   3.7360962816214952`*^9}, {3.736097265636952*^9, 3.7360972662181053`*^9}, {
   3.7361427730684586`*^9, 3.736142786967091*^9}, {3.7361429395526505`*^9, 
   3.7361429399367094`*^9}, {3.7361456385354853`*^9, 3.736145647773047*^9}, {
   3.7361457940966015`*^9, 3.7361458003489246`*^9}, {3.7361479807772937`*^9, 
   3.7361480001513195`*^9}, {3.7361484779289703`*^9, 
   3.7361484874693284`*^9}, {3.736151167964548*^9, 3.736151214340464*^9}, {
   3.736152584980132*^9, 3.736152616490549*^9}, 3.7361529074294634`*^9, 
   3.7361529566400914`*^9, {3.7361531197438593`*^9, 3.73615313179025*^9}, {
   3.7361600789237127`*^9, 3.7361600813580875`*^9}, {3.7361635050115585`*^9, 
   3.736163533463912*^9}, {3.7361644334553747`*^9, 3.7361644338057575`*^9}, {
   3.7362279790764766`*^9, 3.736228032270702*^9}, {3.7362328390168405`*^9, 
   3.7362328408694506`*^9}, {3.736412016557328*^9, 3.736412022914005*^9}, 
   3.7364815312103825`*^9, {3.736481683859022*^9, 3.7364816839823465`*^9}, 
   3.736481815843889*^9, {3.7364825364840155`*^9, 3.7364825453440647`*^9}, {
   3.736482891849559*^9, 3.736482891923483*^9}, {3.736484323508561*^9, 
   3.7364843268249426`*^9}, {3.7364847645303087`*^9, 3.7364847665183306`*^9}, 
   3.7364920191692405`*^9, {3.7364921657699795`*^9, 3.736492165826701*^9}, 
   3.7366673012154317`*^9, {3.73666809453461*^9, 3.7366680946048284`*^9}, 
   3.736782097103197*^9, {3.7367850183587008`*^9, 3.736785025066718*^9}, {
   3.736785061322934*^9, 3.7367850853556614`*^9}, 3.7368517584156976`*^9, {
   3.7368582990044003`*^9, 3.7368583560863895`*^9}, 3.736858526716897*^9, {
   3.7368586492008877`*^9, 3.736858717129797*^9}, {3.7368588001858063`*^9, 
   3.736858866458607*^9}, {3.736858940179243*^9, 3.7368589465502214`*^9}, {
   3.7368589924764147`*^9, 3.736859014101614*^9}, {3.736859046262355*^9, 
   3.736859052569999*^9}, {3.736859351801052*^9, 3.7368593659443073`*^9}, {
   3.7368663005171733`*^9, 3.73686630068001*^9}, 3.736866400802652*^9, {
   3.736866465417356*^9, 3.7368664673121133`*^9}, {3.73686669834263*^9, 
   3.7368667009804106`*^9}, {3.7368668401080923`*^9, 
   3.7368668409069796`*^9}, {3.736866886407938*^9, 3.736866893403507*^9}, {
   3.7368671253434277`*^9, 3.736867125435185*^9}, {3.7368672774770947`*^9, 
   3.7368672851343465`*^9}, {3.736917535059682*^9, 3.736917536516204*^9}, {
   3.7369320881153126`*^9, 3.7369321217600565`*^9}, {3.73693215928226*^9, 
   3.7369321697090592`*^9}, {3.7379939438160057`*^9, 
   3.7379939521298113`*^9}, {3.745920911853548*^9, 3.7459209167496386`*^9}},
 CellLabel->"In[30]:=",ExpressionUUID->"6808f64a-a8c2-4d2d-a6c3-8968549d21e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"choose", " ", "a", " ", "nice", " ", "image"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"MakeChannelImage", "/@", "testData4"}]}]], "Input",
 CellChangeTimes->{3.8280825908673368`*^9},
 CellLabel->"In[31]:=",ExpressionUUID->"d7cb0519-68ce-44ef-aebc-bbc4934b62ca"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"train", " ", "the", " ", "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"net4", ",", "trained4", ",", "netTrained4"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"result4", ",", "iou4"}], "}"}]}], "}"}], "=", 
    RowBox[{"TrainUNET", "[", 
     RowBox[{"train4", ",", "valid4", ",", 
      RowBox[{"{", 
       RowBox[{"testData4", ",", "testLabel4"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"TargetDevice", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<GPU\>\"", ",", "1"}], "}"}]}], ",", 
      RowBox[{"MaxTrainingRounds", "\[Rule]", "50"}], ",", 
      RowBox[{"NetParameters", "\[Rule]", "32"}], ",", 
      RowBox[{"BlockType", "\[Rule]", "\"\<ResNet\>\""}], ",", 
      RowBox[{"DropOutRate", "\[Rule]", "0.5"}]}], "]"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.7369330399724507`*^9, 3.736933040543474*^9}, {
   3.736959177664871*^9, 3.7369591809157424`*^9}, {3.736960635514878*^9, 
   3.7369606376851454`*^9}, {3.7390083464980707`*^9, 
   3.7390083465755215`*^9}, {3.7450522213050623`*^9, 
   3.7450522362267656`*^9}, {3.7450598036412907`*^9, 3.745059803704013*^9}, {
   3.745137913741931*^9, 3.745137953950053*^9}, 3.745141518994564*^9, {
   3.745142272516852*^9, 3.7451422776799207`*^9}, {3.7459203191009035`*^9, 
   3.7459203417378736`*^9}, {3.745920897293714*^9, 3.7459209042823544`*^9}, {
   3.7462564148739552`*^9, 3.746256416628381*^9}, 3.7634726821073194`*^9, {
   3.7634727276366434`*^9, 3.763472745997533*^9}, {3.7634729234631767`*^9, 
   3.763472926088451*^9}, 3.828081318446*^9, {3.8280814489430275`*^9, 
   3.8280814492532334`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"1b565e84-1233-49bf-a82f-bfd8ecb0e0f5"],

Cell[BoxData[
 RowBox[{"MakeNetPlots", "[", "trained4", "]"}]], "Input",
 CellChangeTimes->{{3.8280816474758863`*^9, 3.828081652401684*^9}, {
  3.8280816908815603`*^9, 3.82808169233667*^9}, {3.8280820185799656`*^9, 
  3.8280820220845504`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"ef0fc598-6b50-4687-9941-ea7295e6480b"],

Cell[BoxData[
 RowBox[{"<<", "QMRITools`"}]], "Input",
 CellChangeTimes->{{3.7634731247419405`*^9, 3.7634731300742836`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"6c180aaf-3ebe-4ce4-81da-9b1702e11e65"],

Cell[BoxData[
 RowBox[{"PlotData", "[", "result4", "]"}]], "Input",
 CellChangeTimes->{{3.7634731197752876`*^9, 3.7634731389635177`*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"e5f884ba-c96b-45a3-ba27-a2c8c10b61db"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MeanSurfaceDistance", "[", 
   RowBox[{"res_", ",", "label_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "resS", ",", "labS", ",", "posR", ",", "posL", ",", "m", ",", "pR", ",", 
      "pL", ",", "mat", ",", "msd", ",", "lpR", ",", "lpL"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"Split", " ", "the", " ", "segmentations"}], "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"resS", "=", 
      RowBox[{
       RowBox[{"SplitSegmentations", "[", "res", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"labS", "=", 
      RowBox[{
       RowBox[{"SplitSegmentations", "[", "label", "]"}], "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Get", " ", "the", " ", "posisitons", " ", "of", " ", "the", " ", 
       "edge", " ", "voxels"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"posR", "=", 
      RowBox[{"aa", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"m", "=", 
              RowBox[{"ArrayPad", "[", 
               RowBox[{"#", ",", "1"}], "]"}]}], ";", 
             RowBox[{"m1", "=", 
              RowBox[{"m", "-", 
               RowBox[{"Erosion", "[", 
                RowBox[{"m", ",", "1"}], "]"}]}]}]}], ",", "1"}], "]"}], 
          "&"}], ",", "resS", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"posL", "=", 
      RowBox[{"bb", "=", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Position", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"m", "=", 
              RowBox[{"ArrayPad", "[", 
               RowBox[{"#", ",", "1"}], "]"}]}], ";", 
             RowBox[{"m2", "=", 
              RowBox[{"m", "-", 
               RowBox[{"Erosion", "[", 
                RowBox[{"m", ",", "1"}], "]"}]}]}]}], ",", "1"}], "]"}], 
          "&"}], ",", "labS", ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "calculate", " ", "the", " ", "MSD", " ", "for", " ", "each", " ", 
       "point", " ", "for", " ", "ech", " ", "ROI"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"msd", "=", 
      RowBox[{"MapThread", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"(", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"pR", "=", "#"}], ";", 
           RowBox[{"pL", "=", "#2"}], ";", "\[IndentingNewLine]", 
           RowBox[{"lpR", "=", 
            RowBox[{"Length", "[", "pR", "]"}]}], ";", 
           RowBox[{"lpL", "=", 
            RowBox[{"Length", "[", "pL", "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"lpR", "\[Equal]", "0"}], "||", 
              RowBox[{"lpL", "\[Equal]", "0"}]}], ",", "\[IndentingNewLine]", 
             "Missing", ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"msd", "=", 
               RowBox[{"ParallelMap", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Norm", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Nearest", "[", 
                    RowBox[{"pL", ",", "#", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "-", "#"}], "]"}], "&"}], 
                 ",", "pR"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"Mean", "[", 
               RowBox[{"N", "[", "msd", "]"}], "]"}]}]}], 
            "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ")"}], 
         "&"}], ",", 
        RowBox[{"{", 
         RowBox[{"posR", ",", "posL"}], "}"}], ",", "2"}], "]"}]}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Mean", "[", 
        RowBox[{"DeleteCases", "[", 
         RowBox[{"#", ",", "Missing"}], "]"}], "]"}], "&"}], "/@", 
      RowBox[{"Transpose", "[", "msd", "]"}]}]}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7499850386403136`*^9, 3.7499851137457795`*^9}, {
   3.7499861803237624`*^9, 3.7499861810005665`*^9}, {3.7502418856072035`*^9, 
   3.750241959059622*^9}, {3.750242054592761*^9, 3.75024210204504*^9}, {
   3.750249722372314*^9, 3.750249722834545*^9}, {3.7502498798123026`*^9, 
   3.7502499071390066`*^9}, 3.7502514434381185`*^9, 
   3.7503922265432315`*^9},ExpressionUUID->"3eb7e172-0287-4d38-bcf2-\
758c5ab7a024"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "layers", " ", "of", " ", "the", " ", 
    "net"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"VisualizeUNET2D", "[", 
   RowBox[{"testData4", ",", "netTrained4"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7367635744536123`*^9, 3.736763586834174*^9}, {
   3.736764000182431*^9, 3.7367640089543753`*^9}, 3.7367643725344725`*^9, {
   3.7367652678051596`*^9, 3.7367652681687517`*^9}, {3.736782988251666*^9, 
   3.7367829947281933`*^9}, {3.7367832730906196`*^9, 3.736783273431922*^9}, {
   3.736932110954464*^9, 3.7369321120053024`*^9}, {3.736932483730036*^9, 
   3.736932484857915*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"c172715b-7ef7-4f63-b6b7-d8ae40ac0b80"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "visualize", " ", "the", " ", "test", " ", "data", " ", "witout", " ", 
    "diff", " ", "image"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"ShowChannelClassData", "[", 
   RowBox[{"testData4", ",", " ", "testLabel4", ",", " ", "result4", ",", " ", 
    RowBox[{"NumberRowItems", "\[Rule]", "2"}], ",", 
    RowBox[{"MakeDifferenceImage", "\[Rule]", "True"}], ",", 
    RowBox[{"StepSize", "\[Rule]", "1"}], ",", 
    RowBox[{"ImageSize", "\[Rule]", "650"}]}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.736932982185239*^9, {3.7369330334249287`*^9, 3.736933036896783*^9}, 
   3.7369331112241325`*^9, {3.7369604850878963`*^9, 3.7369604855128164`*^9}, {
   3.736960532631493*^9, 3.7369605448294716`*^9}},
 CellLabel->"In[34]:=",ExpressionUUID->"dddc753b-5f06-48b1-b030-8906bc1eb54a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Case 5 - same as 4 with animation", "Subsection",
 CellChangeTimes->{{3.736255937786428*^9, 3.736255942050702*^9}, {
   3.7368672510536203`*^9, 3.7368672561377573`*^9}, 3.7368673142797565`*^9, {
   3.736932134631217*^9, 3.736932135741583*^9}, {3.736932194610512*^9, 
   3.7369322014387274`*^9}},ExpressionUUID->"55e4d17f-1be9-48ec-9216-\
de51a96b9f9e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"data5", ",", "label5"}], "}"}], "=", 
   RowBox[{"MakeTestImages", "[", 
    RowBox[{"100", ",", "4"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.736223942920128*^9, 3.736223950732706*^9}, {
  3.7362240856355734`*^9, 3.736224155216504*^9}, {3.736227983792309*^9, 
  3.7362280037391157`*^9}, {3.736411990457652*^9, 3.736411991279434*^9}, {
  3.7364815117213306`*^9, 3.7364815125701046`*^9}, {3.736932202730949*^9, 
  3.736932203782503*^9}, {3.736932992154677*^9, 3.7369329928233414`*^9}},
 CellLabel->"In[31]:=",ExpressionUUID->"06fe11a9-6f87-405a-85b5-10db96ad27d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "train5", ",", "valid5", ",", "testData5", ",", "testLabel5", ",", 
     "order"}], "}"}], "=", 
   RowBox[{"SplitTrainData", "[", 
    RowBox[{"data5", ",", "label5"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7369322060703564`*^9, 3.7369322171393476`*^9}, 
   3.7369331349079065`*^9, {3.7457443291486692`*^9, 3.7457443298812675`*^9}},
 CellLabel->"In[32]:=",ExpressionUUID->"bef28d55-09e5-4665-9030-449498698014"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"choose", " ", "a", " ", "nice", " ", "image"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"MakeChannelImage", "/@", "testData5"}]}]], "Input",
 CellChangeTimes->{{3.73693547211168*^9, 3.736935510323561*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"96777a71-dc2b-4b13-811e-f22204717f57"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"im", "=", "2"}], ";", 
  RowBox[{"nchan", "=", 
   RowBox[{"Max", "[", "testLabel5", "]"}]}], ";", 
  RowBox[{"solutions", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"imChan", "=", 
    RowBox[{"First", "@", 
     RowBox[{"MakeChannelImage", "[", 
      RowBox[{"testData5", "[", 
       RowBox[{"[", 
        RowBox[{"im", ",", 
         RowBox[{"{", "1", "}"}]}], "]"}], "]"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"The", " ", "monitoring", " ", "function"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"monitor", "=", 
    RowBox[{
     RowBox[{"AppendTo", "[", 
      RowBox[{"solutions", ",", 
       RowBox[{"ClassDecoder", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"NetExtract", "[", 
           RowBox[{"#Net", ",", "\"\<net\>\""}], "]"}], "[", 
          RowBox[{
           RowBox[{"testData5", "[", 
            RowBox[{"[", "im", "]"}], "]"}], ",", 
           RowBox[{"TargetDevice", "\[Rule]", "\"\<GPU\>\""}]}], "]"}], ",", 
         "nchan"}], "]"}]}], "]"}], "&"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "train", " ", "the", " ", "net", " ", "with", " ", "monitor", " ", 
    "function"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"net", ",", "trained", ",", "netTrained"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"plots", ",", "result", ",", "iou"}], "}"}]}], "}"}], "=", 
   RowBox[{"TrainUNET", "[", 
    RowBox[{"train5", ",", "valid5", ",", 
     RowBox[{"{", 
      RowBox[{"testData5", ",", "testLabel5"}], "}"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"TargetDevice", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<GPU\>\"", ",", "1"}], "}"}]}], ",", 
     RowBox[{"MaxTrainingRounds", "\[Rule]", "100"}], ",", 
     RowBox[{"NetParameters", "\[Rule]", "32"}], ",", 
     RowBox[{"DropOutRate", "\[Rule]", ".5"}], ",", "\[IndentingNewLine]", 
     RowBox[{"BlockType", "\[Rule]", "\"\<ResNet\>\""}], ",", 
     RowBox[{"TrainingProgressFunction", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"monitor", ",", 
        RowBox[{"\"\<Interval\>\"", "\[Rule]", 
         RowBox[{"Quantity", "[", 
          RowBox[{"1", ",", "\"\<Batches\>\""}], "]"}]}]}], "}"}]}]}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.736092162506568*^9, 3.7360921717151403`*^9}, {
   3.736093115569694*^9, 3.7360931493970985`*^9}, {3.7360962453078156`*^9, 
   3.7360962816214952`*^9}, {3.736097265636952*^9, 3.7360972662181053`*^9}, {
   3.7361427730684586`*^9, 3.736142786967091*^9}, {3.7361429395526505`*^9, 
   3.7361429399367094`*^9}, {3.7361456385354853`*^9, 3.736145647773047*^9}, {
   3.7361457940966015`*^9, 3.7361458003489246`*^9}, {3.7361479807772937`*^9, 
   3.7361480001513195`*^9}, {3.7361484779289703`*^9, 
   3.7361484874693284`*^9}, {3.736151167964548*^9, 3.736151214340464*^9}, {
   3.736152584980132*^9, 3.736152616490549*^9}, 3.7361529074294634`*^9, 
   3.7361529566400914`*^9, {3.7361531197438593`*^9, 3.73615313179025*^9}, {
   3.7361600789237127`*^9, 3.7361600813580875`*^9}, {3.7361635050115585`*^9, 
   3.736163533463912*^9}, {3.7361644334553747`*^9, 3.7361644338057575`*^9}, {
   3.7362279790764766`*^9, 3.736228032270702*^9}, {3.7362328390168405`*^9, 
   3.7362328408694506`*^9}, {3.736412016557328*^9, 3.736412022914005*^9}, 
   3.7364815312103825`*^9, {3.736481683859022*^9, 3.7364816839823465`*^9}, 
   3.736481815843889*^9, {3.7364825364840155`*^9, 3.7364825453440647`*^9}, {
   3.736482891849559*^9, 3.736482891923483*^9}, {3.736484323508561*^9, 
   3.7364843268249426`*^9}, {3.7364847645303087`*^9, 3.7364847665183306`*^9}, 
   3.7364920191692405`*^9, {3.7364921657699795`*^9, 3.736492165826701*^9}, 
   3.7366673012154317`*^9, {3.73666809453461*^9, 3.7366680946048284`*^9}, 
   3.736782097103197*^9, {3.7367850183587008`*^9, 3.736785025066718*^9}, {
   3.736785061322934*^9, 3.7367850853556614`*^9}, 3.7368517584156976`*^9, {
   3.7368582990044003`*^9, 3.7368583560863895`*^9}, 3.736858526716897*^9, {
   3.7368586492008877`*^9, 3.736858717129797*^9}, {3.7368588001858063`*^9, 
   3.736858866458607*^9}, {3.736858940179243*^9, 3.7368589465502214`*^9}, {
   3.7368589924764147`*^9, 3.736859014101614*^9}, {3.736859046262355*^9, 
   3.736859052569999*^9}, {3.736859351801052*^9, 3.7368593659443073`*^9}, {
   3.7368663005171733`*^9, 3.73686630068001*^9}, 3.736866400802652*^9, {
   3.736866465417356*^9, 3.7368664673121133`*^9}, {3.73686669834263*^9, 
   3.7368667009804106`*^9}, {3.7368668401080923`*^9, 
   3.7368668409069796`*^9}, {3.736866886407938*^9, 3.736866893403507*^9}, {
   3.7368671253434277`*^9, 3.736867125435185*^9}, 3.7368798261569777`*^9, 
   3.7368799303308864`*^9, {3.7368803799081187`*^9, 3.7368803800487766`*^9}, {
   3.7369176122008257`*^9, 3.73691761866465*^9}, {3.7369321806366863`*^9, 
   3.736932184340496*^9}, {3.736932221681879*^9, 3.7369322590535564`*^9}, {
   3.7369331433651047`*^9, 3.7369331553683662`*^9}, {3.736934283934451*^9, 
   3.7369342923877416`*^9}, 3.736934332795584*^9, {3.7369345153409557`*^9, 
   3.736934527555962*^9}, 3.7369352486234846`*^9, 3.7369354618722663`*^9, 
   3.736935518634939*^9, {3.745061413580042*^9, 3.7450614499150825`*^9}, {
   3.7450615015909233`*^9, 3.745061504956669*^9}, {3.745744347322223*^9, 
   3.745744404794508*^9}, {3.7459217722930684`*^9, 3.7459218313735*^9}, 
   3.746256730439884*^9},
 CellLabel->"In[34]:=",ExpressionUUID->"b7fa51b1-f13a-4548-a211-50b5ce13ed63"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"make", " ", "the", " ", "animation", " ", "images"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"solIm", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"ColorReplace", "[", 
        RowBox[{
         RowBox[{"MakeClassImage", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "4"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"ColorData", "[", "\"\<Rainbow\>\"", "]"}], "[", "0", 
          "]"}]}], "]"}], "&"}], "/@", "solutions"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"anim", "=", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"ImageCompose", "[", 
          RowBox[{"imChan", ",", 
           RowBox[{"{", 
            RowBox[{"sol", ",", ".5"}], "}"}]}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "500"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"sol", ",", "solIm"}], "}"}]}], "]"}]}], ";"}]}]}]], "Input",
 CellLabel->"In[38]:=",ExpressionUUID->"0c83e808-9b15-4870-a4a9-6bb22404d2fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"play", " ", "the", " ", "animatin"}], "*)"}], "\n", 
  RowBox[{"Animate", "[", 
   RowBox[{"im", ",", 
    RowBox[{"{", 
     RowBox[{"im", ",", "anim"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.736859243896474*^9, 3.7368592481548557`*^9}, {
   3.73686599490224*^9, 3.736866002652094*^9}, {3.736866113477438*^9, 
   3.736866121412077*^9}, {3.7368668995294886`*^9, 3.7368668997701526`*^9}, 
   3.736867743709632*^9, {3.736868726927074*^9, 3.736868727217298*^9}, 
   3.7369176301981907`*^9, {3.736932276678276*^9, 3.736932304492243*^9}, {
   3.7369330003979373`*^9, 3.7369330006792192`*^9}, {3.736934201526479*^9, 
   3.736934208657113*^9}, 3.73693425690477*^9, 3.736934288712353*^9, {
   3.736934420886116*^9, 3.7369344503855534`*^9}, {3.7369345396756024`*^9, 
   3.7369345425279655`*^9}, {3.7369353647377224`*^9, 3.736935440877657*^9}},
 CellLabel->"In[40]:=",ExpressionUUID->"69f59734-498d-4561-bfd0-e6dab2a806b6"],

Cell[BoxData[
 RowBox[{"Export", "[", 
  RowBox[{"\"\<anim.gif\>\"", ",", "anim", ",", 
   RowBox[{"\"\<DisplayDuration\>\"", "\[Rule]", ".2"}], ",", 
   RowBox[{"\"\<AnimationRepetitions\>\"", "\[Rule]", "Infinity"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.745061655136744*^9, 3.745061663453594*^9}, {
  3.7450617026360784`*^9, 3.745061787290922*^9}, {3.74506190779112*^9, 
  3.745061909851161*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"7bf644ba-e208-4ac9-aaa9-433cfb0043e2"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1200, 1877},
WindowMargins->{{-1208, Automatic}, {-381, Automatic}},
FrontEndVersion->"13.0 for Microsoft Windows (64-bit) (December 2, 2021)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"b992c3e2-6df5-43a7-a7fd-f43f4c1fa7ce"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 211, 3, 29, "Input",ExpressionUUID->"80736651-f97a-4200-a95d-e5276942b499"],
Cell[794, 27, 154, 2, 33, "Output",ExpressionUUID->"636d88f2-cf27-4d98-8754-b56a1417256b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[985, 34, 249, 4, 29, "Input",ExpressionUUID->"6cde7411-8cca-411f-86d1-0325e4d2643a"],
Cell[CellGroupData[{
Cell[1259, 42, 219, 4, 23, "Print",ExpressionUUID->"5170b966-c667-4dc2-b637-50709e10d45c"],
Cell[1481, 48, 222, 4, 23, "Print",ExpressionUUID->"fe21444d-b6c1-4cee-be7d-d8d0a29bc051"],
Cell[1706, 54, 267, 7, 23, "Print",ExpressionUUID->"b50d93d5-987b-4cec-922d-0a2f6b67f314"],
Cell[1976, 63, 221, 4, 23, "Print",ExpressionUUID->"eebcbe40-b7f2-4310-a2db-39be66ba9edc"],
Cell[2200, 69, 223, 4, 23, "Print",ExpressionUUID->"da54ca5e-2463-4e22-8ab3-5f324dc907be"],
Cell[2426, 75, 1804, 32, 78, "Print",ExpressionUUID->"adab6510-09df-44a7-9de5-bcd195113ab8"],
Cell[4233, 109, 370, 9, 42, "Print",ExpressionUUID->"cf9c9ce8-7e3d-4964-8d37-93a2a59d8c9b"],
Cell[4606, 120, 226, 4, 23, "Print",ExpressionUUID->"da9828d8-ad7a-416a-b9d1-36d9eea0125f"],
Cell[4835, 126, 613, 15, 42, "Print",ExpressionUUID->"7f7d7aa4-5f1c-4bfb-b43f-13230872b32f"],
Cell[5451, 143, 370, 9, 42, "Print",ExpressionUUID->"9ad66a3b-ae92-46ff-bab4-6a64ac6c3c87"],
Cell[5824, 154, 221, 4, 23, "Print",ExpressionUUID->"135da847-1ade-46e4-8413-4fab28de5783"],
Cell[6048, 160, 222, 4, 23, "Print",ExpressionUUID->"de2da9f6-3528-45ea-8d90-c41c9dea92c6"],
Cell[6273, 166, 227, 4, 23, "Print",ExpressionUUID->"575f737e-2284-4bfb-9abe-86492d7c65de"],
Cell[6503, 172, 219, 4, 23, "Print",ExpressionUUID->"851a0a48-bde5-4f34-a8a0-df7338b5fff0"],
Cell[6725, 178, 225, 4, 23, "Print",ExpressionUUID->"6c92f8a9-771d-4280-9022-67e408cd4729"],
Cell[6953, 184, 1098, 19, 60, "Print",ExpressionUUID->"a4d1dd0d-05e2-41bb-9e49-f5ffd308ebbc"],
Cell[8054, 205, 221, 4, 23, "Print",ExpressionUUID->"a7359c79-6665-4f39-924f-4a3a9df3ca96"],
Cell[8278, 211, 230, 5, 23, "Print",ExpressionUUID->"b9008b45-5df8-40eb-8180-6c42948a0990"],
Cell[8511, 218, 356, 8, 23, "Print",ExpressionUUID->"590e1faa-6c2d-40c5-a12a-7da695e95a73"],
Cell[8870, 228, 219, 4, 23, "Print",ExpressionUUID->"bfa6a001-281e-4cef-bc4b-6b2b90fbed88"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9138, 238, 212, 4, 67, "Section",ExpressionUUID->"ebfce3f0-781e-489b-a324-413b4e2a0e96"],
Cell[CellGroupData[{
Cell[9375, 246, 259, 4, 54, "Subsection",ExpressionUUID->"efe280f3-51c2-47b4-bc78-b0dd9eb22424"],
Cell[9637, 252, 294, 7, 29, "Input",ExpressionUUID->"c50cec09-b001-43dc-bce8-060fc1ebe1c5"],
Cell[9934, 261, 590, 9, 29, "Input",ExpressionUUID->"f945d82f-8def-4ae4-8544-3ae92921c382"],
Cell[10527, 272, 500, 9, 29, "Input",ExpressionUUID->"71998f84-3622-409a-8e60-749763d086f5"],
Cell[11030, 283, 469, 8, 29, "Input",ExpressionUUID->"9e7ddaa3-307e-4dd2-ae62-b79aeaefa225"],
Cell[11502, 293, 675, 12, 29, "Input",ExpressionUUID->"4b5f34bf-287a-4137-9f05-93f897bfd421"],
Cell[12180, 307, 697, 13, 29, "Input",ExpressionUUID->"2dc3f972-5ec6-4802-9dad-d19e96ab1bdf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12914, 325, 261, 4, 54, "Subsection",ExpressionUUID->"c2c1a71e-7be2-429c-b2b4-d117e403cf3c"],
Cell[13178, 331, 278, 6, 29, "Input",ExpressionUUID->"6d339c2b-2d9d-44dd-9e0a-4a0dbeecbfc6"],
Cell[13459, 339, 590, 9, 29, "Input",ExpressionUUID->"2e5674ad-0fe3-4174-a86f-90995360b162"],
Cell[14052, 350, 500, 9, 29, "Input",ExpressionUUID->"5e4eecce-caf9-4cb0-b292-96f4955fe501"],
Cell[14555, 361, 469, 8, 29, "Input",ExpressionUUID->"33f4c15b-7088-4cb8-9e81-d426ff056818"],
Cell[15027, 371, 675, 12, 29, "Input",ExpressionUUID->"b10a0e6b-4f32-40ae-8896-6f45a3790cde"],
Cell[15705, 385, 697, 13, 29, "Input",ExpressionUUID->"ae4bf7b0-fe1c-439e-8188-624c257a1963"]
}, Open  ]],
Cell[CellGroupData[{
Cell[16439, 403, 214, 4, 54, "Subsection",ExpressionUUID->"76f5f44a-4849-492f-91b6-2840ffd5e759"],
Cell[16656, 409, 855, 22, 70, "Input",ExpressionUUID->"e9d3eac5-b44d-46ba-bec8-b2559cec9e1f"],
Cell[17514, 433, 595, 13, 29, "Input",ExpressionUUID->"aa44630a-691e-45b3-bd9f-cbadf2fdcdd1"],
Cell[18112, 448, 2431, 67, 170, "Input",ExpressionUUID->"7f5059a8-2613-4aa5-a092-89b68762a5b0"],
Cell[20546, 517, 4504, 93, 190, "Input",ExpressionUUID->"b761a02b-0a72-4ab9-963b-f19b4aeedd21"],
Cell[25053, 612, 3876, 85, 190, "Input",ExpressionUUID->"aed1bab8-edac-4d92-9541-4eccb772481b"],
Cell[28932, 699, 2109, 50, 90, "Input",ExpressionUUID->"07ad3080-a62c-4a34-acaa-ac7731a8deaf"],
Cell[31044, 751, 414, 10, 29, "Input",ExpressionUUID->"13c62ff2-efd8-49ab-9e9d-4cee405fe2c5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[31495, 766, 222, 4, 54, "Subsection",ExpressionUUID->"82f847f8-af86-4335-b010-0b525865d7eb"],
Cell[31720, 772, 598, 14, 50, "Input",ExpressionUUID->"836a86c0-c7ac-4ccb-bfdc-9ed48356a9a9"],
Cell[32321, 788, 652, 14, 50, "Input",ExpressionUUID->"68d492e8-df7c-44dd-bd79-7202d31beee2"],
Cell[32976, 804, 685, 17, 50, "Input",ExpressionUUID->"f0cb3ed1-b97f-4cd2-8a80-5c47ebc56121"],
Cell[33664, 823, 664, 16, 50, "Input",ExpressionUUID->"970c22ac-cfcc-428b-a387-451a782d95b5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34365, 844, 313, 5, 54, "Subsection",ExpressionUUID->"f0a4d34d-373a-4eff-a8eb-07e59aabf187"],
Cell[34681, 851, 654, 14, 50, "Input",ExpressionUUID->"5f25cc7b-42de-4d1f-a5d8-82a79441e73b"],
Cell[CellGroupData[{
Cell[35360, 869, 630, 15, 50, "Input",ExpressionUUID->"c77bf1f8-94d6-421e-8d4c-e02cd6b94c6e"],
Cell[CellGroupData[{
Cell[36015, 888, 909, 19, 23, "Print",ExpressionUUID->"3b8b8709-b225-40d1-a3b5-3a7b39b24eaa"],
Cell[36927, 909, 1098, 24, 23, "Print",ExpressionUUID->"79836205-c345-4630-b789-d0a96ac11da4"],
Cell[38028, 935, 809, 16, 23, "Print",ExpressionUUID->"854aa1dc-fd92-4871-81aa-3532bbe31014"]
}, Open  ]]
}, Open  ]],
Cell[38864, 955, 634, 12, 50, "Input",ExpressionUUID->"e2cf3ad1-b30f-4d54-b606-a90ee104565a"],
Cell[39501, 969, 2552, 49, 90, "Input",ExpressionUUID->"e628eb92-cfc7-44bc-8c58-0ac81605d1ae"],
Cell[42056, 1020, 750, 14, 36, "Input",ExpressionUUID->"18a352a1-5023-43ff-8324-5c2f5303f12b"],
Cell[42809, 1036, 807, 15, 36, "Input",ExpressionUUID->"b0544004-dc84-4858-852b-930cdc49ac1d"],
Cell[43619, 1053, 804, 15, 36, "Input",ExpressionUUID->"d42a3795-8587-44e7-897d-9edcd48c49eb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44460, 1073, 261, 4, 41, "Subsection",ExpressionUUID->"ae8a8131-f090-4256-99d8-202947e3efc1"],
Cell[44724, 1079, 676, 14, 36, "Input",ExpressionUUID->"b5a917a9-f063-4532-b914-d9977b90bb50"],
Cell[45403, 1095, 628, 15, 36, "Input",ExpressionUUID->"7d59c487-cc4e-4c58-95d2-35721084a132"],
Cell[46034, 1112, 1743, 35, 64, "Input",ExpressionUUID->"e011104e-23ba-49d9-89cd-0622d4202e2e"],
Cell[47780, 1149, 749, 14, 36, "Input",ExpressionUUID->"eba55e35-2f18-4a6f-9d99-93a7d09cf581"],
Cell[48532, 1165, 1003, 17, 36, "Input",ExpressionUUID->"25af0373-c2c0-46f7-bf72-f026e1a97ed9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49572, 1187, 287, 4, 41, "Subsection",ExpressionUUID->"07eca103-b55f-49fe-a389-80f1a5adc8a6"],
Cell[49862, 1193, 1502, 26, 36, "Input",ExpressionUUID->"559b218e-8545-4e88-8a6a-59431ce4a153"],
Cell[51367, 1221, 1621, 38, 79, "Input",ExpressionUUID->"b96d6ba5-2b34-4463-9bb7-4f36dafed980"],
Cell[52991, 1261, 1071, 22, 36, "Input",ExpressionUUID->"60d35187-9ae0-44fc-bb7e-d20386da86c6"],
Cell[54065, 1285, 2567, 45, 50, "Input",ExpressionUUID->"3b06b214-da8b-49f4-8dd6-9127f80c8428"],
Cell[56635, 1332, 700, 13, 36, "Input",ExpressionUUID->"1426dd22-e2b5-49c7-a999-33fe81b7b170"],
Cell[57338, 1347, 606, 12, 36, "Input",ExpressionUUID->"a6d792fe-f1f2-4dfd-84f2-7dab9eca61a5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[57981, 1364, 317, 5, 41, "Subsection",ExpressionUUID->"964043c3-f1f7-4146-9417-e090d9b9606d"],
Cell[58301, 1371, 757, 15, 36, "Input",ExpressionUUID->"125b3671-af9a-4048-a4a0-c53abca87d8a"],
Cell[59061, 1388, 3119, 48, 36, "Input",ExpressionUUID->"6808f64a-a8c2-4d2d-a6c3-8968549d21e1"],
Cell[62183, 1438, 321, 7, 36, "Input",ExpressionUUID->"d7cb0519-68ce-44ef-aebc-bbc4934b62ca"],
Cell[62507, 1447, 1804, 36, 50, "Input",ExpressionUUID->"1b565e84-1233-49bf-a82f-bfd8ecb0e0f5"],
Cell[64314, 1485, 322, 5, 21, "Input",ExpressionUUID->"ef0fc598-6b50-4687-9941-ea7295e6480b"],
Cell[64639, 1492, 202, 3, 21, "Input",ExpressionUUID->"6c180aaf-3ebe-4ce4-81da-9b1702e11e65"],
Cell[64844, 1497, 215, 3, 21, "Input",ExpressionUUID->"e5f884ba-c96b-45a3-ba27-a2c8c10b61db"],
Cell[65062, 1502, 4709, 116, 293, "Input",ExpressionUUID->"3eb7e172-0287-4d38-bcf2-758c5ab7a024"],
Cell[69774, 1620, 752, 15, 36, "Input",ExpressionUUID->"c172715b-7ef7-4f63-b6b7-d8ae40ac0b80"],
Cell[70529, 1637, 839, 16, 36, "Input",ExpressionUUID->"dddc753b-5f06-48b1-b030-8906bc1eb54a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71405, 1658, 363, 5, 41, "Subsection",ExpressionUUID->"55e4d17f-1be9-48ec-9216-de51a96b9f9e"],
Cell[71771, 1665, 637, 12, 21, "Input",ExpressionUUID->"06fe11a9-6f87-405a-85b5-10db96ad27d6"],
Cell[72411, 1679, 491, 11, 21, "Input",ExpressionUUID->"bef28d55-09e5-4665-9030-449498698014"],
Cell[72905, 1692, 342, 7, 36, "Input",ExpressionUUID->"96777a71-dc2b-4b13-811e-f22204717f57"],
Cell[73250, 1701, 5604, 110, 136, "Input",ExpressionUUID->"b7fa51b1-f13a-4548-a211-50b5ce13ed63"],
Cell[78857, 1813, 1140, 33, 50, "Input",ExpressionUUID->"0c83e808-9b15-4870-a4a9-6bb22404d2fa"],
Cell[80000, 1848, 978, 17, 36, "Input",ExpressionUUID->"69f59734-498d-4561-bfd0-e6dab2a806b6"],
Cell[80981, 1867, 484, 9, 21, "Input",ExpressionUUID->"7bf644ba-e208-4ac9-aaa9-433cfb0043e2"]
}, Open  ]]
}, Open  ]]
}
]
*)

